"use strict";(self.webpackChunkproton_pass_extension=self.webpackChunkproton_pass_extension||[]).push([["node_modules_openpgp_dist_lightweight_noble_curves_min_mjs"],{62377:(e,t,f)=>{var r;let i,n;f.d(t,{C:()=>U,H:()=>A,M:()=>k,a:()=>d,b:()=>B,c:()=>O,d:()=>c,e:()=>l,f:()=>b,g:()=>u,h:()=>v,i:()=>a,j:()=>eh,k:()=>eu,l:()=>S,m:()=>eL,n:()=>eC,o:()=>eq,p:()=>eN,q:()=>L,r:()=>F,s:()=>ed,t:()=>I,u:()=>y,v:()=>ek,w:()=>R,x:()=>eU,y:()=>eH});let o="undefined"!=typeof window?window:void 0!==f.g?f.g:"undefined"!=typeof self?self:{},s="object"==typeof o&&"crypto"in o?o.crypto:void 0;function a(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function c(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function d(e,...t){if(!a(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function l(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");c(e.outputLen),c(e.blockLen)}function u(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function h(e,t){d(e);let f=t.outputLen;if(e.length<f)throw Error("digestInto() expects output buffer of length at least "+f)}function b(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function g(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function p(e,t){return e<<32-t|e>>>t}function y(e,t){return e<<t|e>>>32-t>>>0}let x=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0]?e=>e:function(e){var t;for(let f=0;f<e.length;f++)e[f]=(t=e[f])<<24&0xff000000|t<<8&0xff0000|t>>>8&65280|t>>>24&255;return e},m="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,w=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function B(e){if(d(e),m)return e.toHex();let t="";for(let f=0;f<e.length;f++)t+=w[e[f]];return t}function E(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function v(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(m)return Uint8Array.fromHex(e);let t=e.length,f=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(f);for(let t=0,i=0;t<f;t++,i+=2){let f=E(e.charCodeAt(i)),n=E(e.charCodeAt(i+1));if(void 0===f||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[i]+e[i+1])+'" at index '+i);r[t]=16*f+n}return r}function I(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),d(e),e}function O(...e){let t=0;for(let f=0;f<e.length;f++){let r=e[f];d(r),t+=r.length}let f=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){let i=e[t];f.set(i,r),r+=i.length}return f}class A{}function S(e){let t=t=>e().update(I(t)).digest(),f=e();return t.outputLen=f.outputLen,t.blockLen=f.blockLen,t.create=()=>e(),t}let R=S;function F(e=32){if(s&&"function"==typeof s.getRandomValues)return s.getRandomValues(new Uint8Array(e));if(s&&"function"==typeof s.randomBytes)return Uint8Array.from(s.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}function U(e,t,f){return e&t^~e&f}function k(e,t,f){return e&t^e&f^t&f}class L extends A{constructor(e,t,f,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=f,this.isLE=r,this.buffer=new Uint8Array(e),this.view=g(this.buffer)}update(e){u(this),d(e=I(e));let{view:t,buffer:f,blockLen:r}=this,i=e.length;for(let n=0;n<i;){let o=Math.min(r-this.pos,i-n);if(o!==r)f.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===r&&(this.process(t,0),this.pos=0);else{let t=g(e);for(;r<=i-n;n+=r)this.process(t,n)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){u(this),h(e,this),this.finished=!0;let{buffer:t,view:f,blockLen:r,isLE:i}=this,{pos:n}=this;t[n++]=128,b(this.buffer.subarray(n)),this.padOffset>r-n&&(this.process(f,0),n=0);for(let e=n;e<r;e++)t[e]=0;!function(e,t,f,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,f,r);let i=BigInt(32),n=BigInt(0xffffffff),o=Number(f>>i&n),s=Number(f&n),a=4*!!r,c=4*!r;e.setUint32(t+a,o,r),e.setUint32(t+c,s,r)}(f,r-8,BigInt(8*this.length),i),this.process(f,0);let o=g(e),s=this.outputLen;if(s%4)throw Error("_sha2: outputLen should be aligned to 32bit");let a=s/4,c=this.get();if(a>c.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<a;e++)o.setUint32(4*e,c[e],i)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let f=e.slice(0,t);return this.destroy(),f}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:f,length:r,finished:i,destroyed:n,pos:o}=this;return e.destroyed=n,e.finished=i,e.length=r,e.pos=o,r%t&&e.buffer.set(f),e}clone(){return this._cloneInto()}}let C=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),H=Uint32Array.from([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]),N=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),q=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),Z=BigInt(0x100000000-1),V=BigInt(32);function P(e,t=!1){let f=e.length,r=new Uint32Array(f),i=new Uint32Array(f);for(let n=0;n<f;n++){let{h:f,l:o}=function(e,t=!1){return t?{h:Number(e&Z),l:Number(e>>V&Z)}:{h:0|Number(e>>V&Z),l:0|Number(e&Z)}}(e[n],t);[r[n],i[n]]=[f,o]}return[r,i]}let K=(e,t,f)=>e>>>f,G=(e,t,f)=>e<<32-f|t>>>f,T=(e,t,f)=>e>>>f|t<<32-f,_=(e,t,f)=>e<<32-f|t>>>f,j=(e,t,f)=>e<<64-f|t>>>f-32,D=(e,t,f)=>e>>>f-32|t<<64-f;function Y(e,t,f,r){let i=(t>>>0)+(r>>>0);return{h:e+f+(i/0x100000000|0)|0,l:0|i}}let z=(e,t,f)=>(e>>>0)+(t>>>0)+(f>>>0),X=(e,t,f,r)=>t+f+r+(e/0x100000000|0)|0,M=(e,t,f,r)=>(e>>>0)+(t>>>0)+(f>>>0)+(r>>>0),$=(e,t,f,r,i)=>t+f+r+i+(e/0x100000000|0)|0,W=(e,t,f,r,i)=>(e>>>0)+(t>>>0)+(f>>>0)+(r>>>0)+(i>>>0),J=(e,t,f,r,i,n)=>t+f+r+i+n+(e/0x100000000|0)|0,Q=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),ee=new Uint32Array(64);class et extends L{constructor(e=32){super(64,e,8,!1),this.A=0|C[0],this.B=0|C[1],this.C=0|C[2],this.D=0|C[3],this.E=0|C[4],this.F=0|C[5],this.G=0|C[6],this.H=0|C[7]}get(){let{A:e,B:t,C:f,D:r,E:i,F:n,G:o,H:s}=this;return[e,t,f,r,i,n,o,s]}set(e,t,f,r,i,n,o,s){this.A=0|e,this.B=0|t,this.C=0|f,this.D=0|r,this.E=0|i,this.F=0|n,this.G=0|o,this.H=0|s}process(e,t){for(let f=0;f<16;f++,t+=4)ee[f]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=ee[e-15],f=ee[e-2],r=p(t,7)^p(t,18)^t>>>3,i=p(f,17)^p(f,19)^f>>>10;ee[e]=i+ee[e-7]+r+ee[e-16]|0}let{A:f,B:r,C:i,D:n,E:o,F:s,G:a,H:c}=this;for(let e=0;e<64;e++){var d;let t=c+(p(o,6)^p(o,11)^p(o,25))+((d=o)&s^~d&a)+Q[e]+ee[e]|0,l=(p(f,2)^p(f,13)^p(f,22))+k(f,r,i)|0;c=a,a=s,s=o,o=n+t|0,n=i,i=r,r=f,f=t+l|0}f=f+this.A|0,r=r+this.B|0,i=i+this.C|0,n=n+this.D|0,o=o+this.E|0,s=s+this.F|0,a=a+this.G|0,c=c+this.H|0,this.set(f,r,i,n,o,s,a,c)}roundClean(){b(ee)}destroy(){this.set(0,0,0,0,0,0,0,0),b(this.buffer)}}class ef extends et{constructor(){super(28),this.A=0|H[0],this.B=0|H[1],this.C=0|H[2],this.D=0|H[3],this.E=0|H[4],this.F=0|H[5],this.G=0|H[6],this.H=0|H[7]}}let er=P(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ei=er[0],en=er[1],eo=new Uint32Array(80),es=new Uint32Array(80);class ea extends L{constructor(e=64){super(128,e,16,!1),this.Ah=0|q[0],this.Al=0|q[1],this.Bh=0|q[2],this.Bl=0|q[3],this.Ch=0|q[4],this.Cl=0|q[5],this.Dh=0|q[6],this.Dl=0|q[7],this.Eh=0|q[8],this.El=0|q[9],this.Fh=0|q[10],this.Fl=0|q[11],this.Gh=0|q[12],this.Gl=0|q[13],this.Hh=0|q[14],this.Hl=0|q[15]}get(){let{Ah:e,Al:t,Bh:f,Bl:r,Ch:i,Cl:n,Dh:o,Dl:s,Eh:a,El:c,Fh:d,Fl:l,Gh:u,Gl:h,Hh:b,Hl:g}=this;return[e,t,f,r,i,n,o,s,a,c,d,l,u,h,b,g]}set(e,t,f,r,i,n,o,s,a,c,d,l,u,h,b,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|f,this.Bl=0|r,this.Ch=0|i,this.Cl=0|n,this.Dh=0|o,this.Dl=0|s,this.Eh=0|a,this.El=0|c,this.Fh=0|d,this.Fl=0|l,this.Gh=0|u,this.Gl=0|h,this.Hh=0|b,this.Hl=0|g}process(e,t){for(let f=0;f<16;f++,t+=4)eo[f]=e.getUint32(t),es[f]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|eo[e-15],f=0|es[e-15],r=T(t,f,1)^T(t,f,8)^K(t,0,7),i=_(t,f,1)^_(t,f,8)^G(t,f,7),n=0|eo[e-2],o=0|es[e-2],s=T(n,o,19)^j(n,o,61)^K(n,0,6),a=M(i,_(n,o,19)^D(n,o,61)^G(n,o,6),es[e-7],es[e-16]),c=$(a,r,s,eo[e-7],eo[e-16]);eo[e]=0|c,es[e]=0|a}let{Ah:f,Al:r,Bh:i,Bl:n,Ch:o,Cl:s,Dh:a,Dl:c,Eh:d,El:l,Fh:u,Fl:h,Gh:b,Gl:g,Hh:p,Hl:y}=this;for(let e=0;e<80;e++){let t=T(d,l,14)^T(d,l,18)^j(d,l,41),x=_(d,l,14)^_(d,l,18)^D(d,l,41),m=d&u^~d&b,w=W(y,x,l&h^~l&g,en[e],es[e]),B=J(w,p,t,m,ei[e],eo[e]),E=0|w,v=T(f,r,28)^j(f,r,34)^j(f,r,39),I=_(f,r,28)^D(f,r,34)^D(f,r,39),O=f&i^f&o^i&o,A=r&n^r&s^n&s;p=0|b,y=0|g,b=0|u,g=0|h,u=0|d,h=0|l,({h:d,l}=Y(0|a,0|c,0|B,0|E)),a=0|o,c=0|s,o=0|i,s=0|n,i=0|f,n=0|r;let S=z(E,I,A);f=X(S,B,v,O),r=0|S}({h:f,l:r}=Y(0|this.Ah,0|this.Al,0|f,0|r)),({h:i,l:n}=Y(0|this.Bh,0|this.Bl,0|i,0|n)),({h:o,l:s}=Y(0|this.Ch,0|this.Cl,0|o,0|s)),({h:a,l:c}=Y(0|this.Dh,0|this.Dl,0|a,0|c)),({h:d,l}=Y(0|this.Eh,0|this.El,0|d,0|l)),({h:u,l:h}=Y(0|this.Fh,0|this.Fl,0|u,0|h)),({h:b,l:g}=Y(0|this.Gh,0|this.Gl,0|b,0|g)),({h:p,l:y}=Y(0|this.Hh,0|this.Hl,0|p,0|y)),this.set(f,r,i,n,o,s,a,c,d,l,u,h,b,g,p,y)}roundClean(){b(eo,es)}destroy(){b(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class ec extends ea{constructor(){super(48),this.Ah=0|N[0],this.Al=0|N[1],this.Bh=0|N[2],this.Bl=0|N[3],this.Ch=0|N[4],this.Cl=0|N[5],this.Dh=0|N[6],this.Dl=0|N[7],this.Eh=0|N[8],this.El=0|N[9],this.Fh=0|N[10],this.Fl=0|N[11],this.Gh=0|N[12],this.Gl=0|N[13],this.Hh=0|N[14],this.Hl=0|N[15]}}let ed=S(()=>new et),el=S(()=>new ef),eu=S(()=>new ea),eh=S(()=>new ec),eb=BigInt(0),eg=BigInt(1),ep=BigInt(2),ey=BigInt(7),ex=BigInt(256),em=BigInt(113),ew=[],eB=[],eE=[];for(let e=0,t=eg,f=1,r=0;e<24;e++){[f,r]=[r,(2*f+3*r)%5],ew.push(2*(5*r+f)),eB.push((e+1)*(e+2)/2%64);let i=eb;for(let e=0;e<7;e++)(t=(t<<eg^(t>>ey)*em)%ex)&ep&&(i^=eg<<(eg<<BigInt(e))-eg);eE.push(i)}let ev=P(eE,!0),eI=ev[0],eO=ev[1],eA=(e,t,f)=>f>32?t<<f-32|e>>>64-f:e<<f|t>>>32-f,eS=(e,t,f)=>f>32?e<<f-32|t>>>64-f:t<<f|e>>>32-f;class eR extends A{constructor(e,t,f,r=!1,i=24){var n;if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=f,this.enableXOF=r,this.rounds=i,c(f),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=new Uint32Array((n=this.state).buffer,n.byteOffset,Math.floor(n.byteLength/4))}clone(){return this._cloneInto()}keccak(){x(this.state32),function(e,t=24){let f=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let t=0;t<10;t++)f[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let r=(t+8)%10,i=(t+2)%10,n=f[i],o=f[i+1],s=eA(n,o,1)^f[r],a=eS(n,o,1)^f[r+1];for(let f=0;f<50;f+=10)e[t+f]^=s,e[t+f+1]^=a}let t=e[2],i=e[3];for(let f=0;f<24;f++){let r=eB[f],n=eA(t,i,r),o=eS(t,i,r),s=ew[f];t=e[s],i=e[s+1],e[s]=n,e[s+1]=o}for(let t=0;t<50;t+=10){for(let r=0;r<10;r++)f[r]=e[t+r];for(let r=0;r<10;r++)e[t+r]^=~f[(r+2)%10]&f[(r+4)%10]}e[0]^=eI[r],e[1]^=eO[r]}b(f)}(this.state32,this.rounds),x(this.state32),this.posOut=0,this.pos=0}update(e){u(this),d(e=I(e));let{blockLen:t,state:f}=this,r=e.length;for(let i=0;i<r;){let n=Math.min(t-this.pos,r-i);for(let t=0;t<n;t++)f[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:f,blockLen:r}=this;e[f]^=t,128&t&&f===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){u(this,!1),d(e),this.finish();let t=this.state,{blockLen:f}=this;for(let r=0,i=e.length;r<i;){this.posOut>=f&&this.keccak();let n=Math.min(f-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+n),r),this.posOut+=n,r+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return c(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(h(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,b(this.state)}_cloneInto(e){let{blockLen:t,suffix:f,outputLen:r,rounds:i,enableXOF:n}=this;return e||(e=new eR(t,f,r,n,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=f,e.outputLen=r,e.enableXOF=n,e.destroyed=this.destroyed,e}}let eF=(e,t,f)=>S(()=>new eR(t,e,f)),eU=eF(6,136,32),ek=eF(6,72,64),eL=(r=(e={})=>new eR(136,31,void 0===e.dkLen?32:e.dkLen,!0),(i=(e,t)=>r(t).update(I(e)).digest()).outputLen=(n=r({})).outputLen,i.blockLen=n.blockLen,i.create=e=>r(e),i),eC=ed,eH=el,eN=eu,eq=eh},84676:(e,t,f)=>{let r;f.d(t,{nobleCurves:()=>tr});var i=f(62377);"undefined"!=typeof window?window:void 0!==f.g?f.g:"undefined"!=typeof self&&self;let n=BigInt(0),o=BigInt(1);function s(e,t=""){if("boolean"!=typeof e)throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function a(e,t,f=""){let r=(0,i.i)(e),n=e?.length,o=void 0!==t;if(!r||o&&n!==t)throw Error((f&&`"${f}" `)+"expected Uint8Array"+(o?" of length "+t:"")+", got "+(r?"length="+n:"type="+typeof e));return e}function c(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function d(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?n:BigInt("0x"+e)}function l(e){return d((0,i.b)(e))}function u(e){return(0,i.a)(e),d((0,i.b)(Uint8Array.from(e).reverse()))}function h(e,t){return(0,i.h)(e.toString(16).padStart(2*t,"0"))}function b(e,t){return h(e,t).reverse()}function g(e,t,f){let r;if("string"==typeof t)try{r=(0,i.h)(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,i.i)(t))throw Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}let n=r.length;if("number"==typeof f&&n!==f)throw Error(e+" of length "+f+" expected, got "+n);return r}function p(e){return Uint8Array.from(e)}let y=e=>"bigint"==typeof e&&n<=e;function x(e,t,f,r){if(!(y(t)&&y(f)&&y(r))||!(f<=t)||!(t<r))throw Error("expected valid "+e+": "+f+" <= n < "+r+", got "+t)}function m(e){let t;for(t=0;e>n;e>>=o,t+=1);return t}let w=e=>(o<<BigInt(e))-o;function B(e,t,f={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function r(t,f,r){let i=e[t];if(r&&void 0===i)return;let n=typeof i;if(n!==f||null===i)throw Error(`param "${t}" is invalid: expected ${f}, got ${n}`)}Object.entries(t).forEach(([e,t])=>r(e,t,!1)),Object.entries(f).forEach(([e,t])=>r(e,t,!0))}function E(e){let t=new WeakMap;return(f,...r)=>{let i=t.get(f);if(void 0!==i)return i;let n=e(f,...r);return t.set(f,n),n}}let v=BigInt(0),I=BigInt(1),O=BigInt(2),A=BigInt(3),S=BigInt(4),R=BigInt(5),F=BigInt(7),U=BigInt(8),k=BigInt(9),L=BigInt(16);function C(e,t){let f=e%t;return f>=v?f:t+f}function H(e,t,f){let r=e;for(;t-- >v;)r*=r,r%=f;return r}function N(e,t){if(e===v)throw Error("invert: expected non-zero number");if(t<=v)throw Error("invert: expected positive modulus, got "+t);let f=C(e,t),r=t,i=v,n=I;for(;f!==v;){let e=r%f,t=i-r/f*n;r=f,f=e,i=n,n=t}if(r!==I)throw Error("invert: does not exist");return C(i,t)}function q(e,t,f){if(!e.eql(e.sqr(t),f))throw Error("Cannot find square root")}function Z(e,t){let f=(e.ORDER+I)/S,r=e.pow(t,f);return q(e,r,t),r}function V(e,t){let f=(e.ORDER-R)/U,r=e.mul(t,O),i=e.pow(r,f),n=e.mul(t,i),o=e.mul(e.mul(n,O),i),s=e.mul(n,e.sub(o,e.ONE));return q(e,s,t),s}function P(e){if(e<A)throw Error("sqrt is not defined for small field");let t=e-I,f=0;for(;t%O===v;)t/=O,f++;let r=O,i=j(e);for(;1===T(i,r);)if(r++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===f)return Z;let n=i.pow(r,t),o=(t+I)/O;return function(e,r){if(e.is0(r))return r;if(1!==T(e,r))throw Error("Cannot find square root");let i=f,s=e.mul(e.ONE,n),a=e.pow(r,t),c=e.pow(r,o);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,f=e.sqr(a);for(;!e.eql(f,e.ONE);)if(t++,f=e.sqr(f),t===i)throw Error("Cannot find square root");let r=I<<BigInt(i-t-1),n=e.pow(s,r);i=t,s=e.sqr(n),a=e.mul(a,s),c=e.mul(c,n)}return c}}let K=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function G(e,t,f=!1){let r=Array(t.length).fill(f?e.ZERO:void 0),i=t.reduce((t,f,i)=>e.is0(f)?t:(r[i]=t,e.mul(t,f)),e.ONE),n=e.inv(i);return t.reduceRight((t,f,i)=>e.is0(f)?t:(r[i]=e.mul(t,r[i]),e.mul(t,f)),n),r}function T(e,t){let f=(e.ORDER-I)/O,r=e.pow(t,f),i=e.eql(r,e.ONE),n=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!n&&!o)throw Error("invalid Legendre symbol result");return i?1:n?0:-1}function _(e,t){void 0!==t&&(0,i.d)(t);let f=void 0!==t?t:e.toString(2).length;return{nBitLength:f,nByteLength:Math.ceil(f/8)}}function j(e,t,f=!1,r={}){let i;if(e<=v)throw Error("invalid field: expected ORDER > 0, got "+e);let n,o,s,a=!1;if("object"==typeof t&&null!=t){if(r.sqrt||f)throw Error("cannot specify opts in two arguments");t.BITS&&(n=t.BITS),t.sqrt&&(o=t.sqrt),"boolean"==typeof t.isLE&&(f=t.isLE),"boolean"==typeof t.modFromBytes&&(a=t.modFromBytes),s=t.allowedLengths}else"number"==typeof t&&(n=t),r.sqrt&&(o=r.sqrt);let{nBitLength:c,nByteLength:d}=_(e,n);if(d>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let g=Object.freeze({ORDER:e,isLE:f,BITS:c,BYTES:d,MASK:w(c),ZERO:v,ONE:I,allowedLengths:s,create:t=>C(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return v<=t&&t<e},is0:e=>e===v,isValidNot0:e=>!g.is0(e)&&g.isValid(e),isOdd:e=>(e&I)===I,neg:t=>C(-t,e),eql:(e,t)=>e===t,sqr:t=>C(t*t,e),add:(t,f)=>C(t+f,e),sub:(t,f)=>C(t-f,e),mul:(t,f)=>C(t*f,e),pow:(e,t)=>(function(e,t,f){if(f<v)throw Error("invalid exponent, negatives unsupported");if(f===v)return e.ONE;if(f===I)return t;let r=e.ONE,i=t;for(;f>v;)f&I&&(r=e.mul(r,i)),i=e.sqr(i),f>>=I;return r})(g,e,t),div:(t,f)=>C(t*N(f,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>N(t,e),sqrt:o||(t=>{let f,r,n,o,s,a;return i||(i=e%S===A?Z:e%U===R?V:e%L===k?(f=j(e),n=(r=P(e))(f,f.neg(f.ONE)),o=r(f,n),s=r(f,f.neg(n)),a=(e+F)/L,(e,t)=>{let f=e.pow(t,a),r=e.mul(f,n),i=e.mul(f,o),c=e.mul(f,s),d=e.eql(e.sqr(r),t),l=e.eql(e.sqr(i),t);f=e.cmov(f,r,d),r=e.cmov(c,i,l);let u=e.eql(e.sqr(r),t),h=e.cmov(f,r,u);return q(e,h,t),h}):P(e)),i(g,t)}),toBytes:e=>f?b(e,d):h(e,d),fromBytes:(t,r=!0)=>{if(s){if(!s.includes(t.length)||t.length>d)throw Error("Field.fromBytes: expected "+s+" bytes, got "+t.length);let e=new Uint8Array(d);e.set(t,f?0:e.length-t.length),t=e}if(t.length!==d)throw Error("Field.fromBytes: expected "+d+" bytes, got "+t.length);let i=f?u(t):l(t);if(a&&(i=C(i,e)),!r&&!g.isValid(i))throw Error("invalid field element: outside of range 0..ORDER");return i},invertBatch:e=>G(g,e),cmov:(e,t,f)=>f?t:e});return Object.freeze(g)}function D(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function Y(e){let t=D(e);return t+Math.ceil(t/2)}class z extends i.H{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,i.e)(e);const f=(0,i.t)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,n=new Uint8Array(r);n.set(f.length>r?e.create().update(f).digest():f);for(let e=0;e<n.length;e++)n[e]^=54;this.iHash.update(n),this.oHash=e.create();for(let e=0;e<n.length;e++)n[e]^=106;this.oHash.update(n),(0,i.f)(n)}update(e){return(0,i.g)(this),this.iHash.update(e),this}digestInto(e){(0,i.g)(this),(0,i.a)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:f,finished:r,destroyed:i,blockLen:n,outputLen:o}=this;return e.finished=r,e.destroyed=i,e.blockLen=n,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=f._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let X=(e,t,f)=>new z(e,t).update(f).digest();X.create=(e,t)=>new z(e,t);let M=BigInt(0),$=BigInt(1);function W(e,t){let f=t.negate();return e?f:t}function J(e,t){let f=G(e.Fp,t.map(e=>e.Z));return t.map((t,r)=>e.fromAffine(t.toAffine(f[r])))}function Q(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function ee(e,t){Q(e,t);let f=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:w(e),maxNumber:f,shiftBy:BigInt(e)}}function et(e,t,f){let{windowSize:r,mask:i,maxNumber:n,shiftBy:o}=f,s=Number(e&i),a=e>>o;s>r&&(s-=n,a+=$);let c=t*r;return{nextN:a,offset:c+Math.abs(s)-1,isZero:0===s,isNeg:s<0,isNegF:t%2!=0,offsetF:c}}let ef=new WeakMap,er=new WeakMap;function ei(e){return er.get(e)||1}function en(e){if(e!==M)throw Error("invalid wNAF")}class eo{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,f=this.ZERO){let r=e;for(;t>M;)t&$&&(f=f.add(r)),r=r.double(),t>>=$;return f}precomputeWindow(e,t){let{windows:f,windowSize:r}=ee(t,this.bits),i=[],n=e,o=n;for(let e=0;e<f;e++){o=n,i.push(o);for(let e=1;e<r;e++)o=o.add(n),i.push(o);n=o.double()}return i}wNAF(e,t,f){if(!this.Fn.isValid(f))throw Error("invalid scalar");let r=this.ZERO,i=this.BASE,n=ee(e,this.bits);for(let e=0;e<n.windows;e++){let{nextN:o,offset:s,isZero:a,isNeg:c,isNegF:d,offsetF:l}=et(f,e,n);f=o,a?i=i.add(W(d,t[l])):r=r.add(W(c,t[s]))}return en(f),{p:r,f:i}}wNAFUnsafe(e,t,f,r=this.ZERO){let i=ee(e,this.bits);for(let e=0;e<i.windows&&f!==M;e++){let{nextN:n,offset:o,isZero:s,isNeg:a}=et(f,e,i);if(f=n,!s){let e=t[o];r=r.add(a?e.negate():e)}}return en(f),r}getPrecomputes(e,t,f){let r=ef.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&("function"==typeof f&&(r=f(r)),ef.set(t,r))),r}cached(e,t,f){let r=ei(e);return this.wNAF(r,this.getPrecomputes(r,e,f),t)}unsafe(e,t,f,r){let i=ei(e);return 1===i?this._unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,f),t,r)}createCache(e,t){Q(t,this.bits),er.set(e,t),ef.delete(e)}hasCache(e){return 1!==ei(e)}}function es(e,t,f,r){!function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,f)=>{if(!(e instanceof t))throw Error("invalid point at index "+f)})}(f,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,f)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+f)})}(r,t);let i=f.length,n=r.length;if(i!==n)throw Error("arrays of points and scalars must have equal length");let o=e.ZERO,s=m(BigInt(i)),a=1;s>12?a=s-3:s>4?a=s-2:s>0&&(a=2);let c=w(a),d=Array(Number(c)+1).fill(o),l=o;for(let e=Math.floor((t.BITS-1)/a)*a;e>=0;e-=a){d.fill(o);for(let t=0;t<n;t++){let i=Number(r[t]>>BigInt(e)&c);d[i]=d[i].add(f[t])}let t=o;for(let e=d.length-1,f=o;e>0;e--)f=f.add(d[e]),t=t.add(f);if(l=l.add(t),0!==e)for(let e=0;e<a;e++)l=l.double()}return l}function ea(e,t,f){if(t){if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return B(t,K.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}return j(e,{isLE:f})}function ec(e,t,f={},r){if(void 0===r&&(r="edwards"===e),!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let f=t[e];if(!("bigint"==typeof f&&f>M))throw Error(`CURVE.${e} must be positive bigint`)}let i=ea(t.p,f.Fp,r),n=ea(t.n,f.Fn,r);for(let f of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!i.isValid(t[f]))throw Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:i,Fn:n}}let ed=(e,t)=>(e+(e>=0?t:-t)/ep)/t;function el(e){if(!["compact","recovered","der"].includes(e))throw Error('Signature format must be "compact", "recovered", or "der"');return e}function eu(e,t){let f={};for(let r of Object.keys(t))f[r]=void 0===e[r]?t[r]:e[r];return s(f.lowS,"lowS"),s(f.prehash,"prehash"),void 0!==f.format&&el(f.format),f}let eh={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:f}=eh;if(e<0||e>256)throw new f("tlv.encode: wrong tag");if(1&t.length)throw new f("tlv.encode: unpadded data");let r=t.length/2,i=c(r);if(i.length/2&128)throw new f("tlv.encode: long form length too big");let n=r>127?c(i.length/2|128):"";return c(e)+n+i+t},decode(e,t){let{Err:f}=eh,r=0;if(e<0||e>256)throw new f("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new f("tlv.decode: wrong tlv");let i=t[r++],n=0;if(128&i){let e=127&i;if(!e)throw new f("tlv.decode(long): indefinite length not supported");if(e>4)throw new f("tlv.decode(long): byte length is too big");let o=t.subarray(r,r+e);if(o.length!==e)throw new f("tlv.decode: length bytes not complete");if(0===o[0])throw new f("tlv.decode(long): zero leftmost byte");for(let e of o)n=n<<8|e;if(r+=e,n<128)throw new f("tlv.decode(long): not minimal encoding")}else n=i;let o=t.subarray(r,r+n);if(o.length!==n)throw new f("tlv.decode: wrong value length");return{v:o,l:t.subarray(r+n)}}},_int:{encode(e){let{Err:t}=eh;if(e<eb)throw new t("integer: negative integers are not allowed");let f=c(e);if(8&Number.parseInt(f[0],16)&&(f="00"+f),1&f.length)throw new t("unexpected DER parsing assertion: unpadded hex");return f},decode(e){let{Err:t}=eh;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return l(e)}},toSig(e){let{Err:t,_int:f,_tlv:r}=eh,i=g("signature",e),{v:n,l:o}=r.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");let{v:s,l:a}=r.decode(2,n),{v:c,l:d}=r.decode(2,a);if(d.length)throw new t("invalid signature: left bytes after parsing");return{r:f.decode(s),s:f.decode(c)}},hexFromSig(e){let{_tlv:t,_int:f}=eh,r=t.encode(2,f.encode(e.r))+t.encode(2,f.encode(e.s));return t.encode(48,r)}},eb=BigInt(0),eg=BigInt(1),ep=BigInt(2),ey=BigInt(3),ex=BigInt(4);function em(e,t){let f,{BYTES:r}=e;if("bigint"==typeof t)f=t;else{let i=g("private key",t);try{f=e.fromBytes(i)}catch(e){throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(f))throw Error("invalid private key: out of range [1..N-1]");return f}function ew(e){return Uint8Array.of(e?2:3)}function eB(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function eE(e,t){let f=t=>(function(e){var t;let f,{CURVE:r,curveOpts:n,hash:o,ecdsaOpts:c}=function(e){let t,f,r,{CURVE:i,curveOpts:n}=(t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},f=e.Fp,r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0,{CURVE:t,curveOpts:{Fp:f,Fn:j(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}),o={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:i,curveOpts:n,hash:e.hash,ecdsaOpts:o}}(e);return f=(t=function(e,t,f={}){(0,i.e)(t),B(f,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let r=f.randomBytes||i.r,n=f.hmac||((e,...f)=>X(t,e,(0,i.c)(...f))),{Fp:o,Fn:s}=e,{ORDER:c,BITS:d}=s,{keygen:p,getPublicKey:y,getSharedSecret:m,utils:E,lengths:v}=function(e,t={}){let{Fn:f}=e,r=t.randomBytes||i.r,n=Object.assign(eB(e.Fp,f),{seed:Y(f.ORDER)});function o(e){try{return!!em(f,e)}catch(e){return!1}}function s(e=r(n.seed)){return function(e,t,f=!1){let r=e.length,i=D(t),n=Y(t);if(r<16||r<n||r>1024)throw Error("expected "+n+"-1024 bytes of input, got "+r);let o=C(f?u(e):l(e),t-I)+I;return f?b(o,i):h(o,i)}(a(e,n.seed,"seed"),f.ORDER)}function c(t,r=!0){return e.BASE.multiply(em(f,t)).toBytes(r)}function d(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let{secretKey:r,publicKey:i,publicKeyUncompressed:o}=n;if(f.allowedLengths||r===i)return;let s=g("key",t).length;return s===i||s===o}return Object.freeze({getPublicKey:c,getSharedSecret:function(t,r,i=!0){if(!0===d(t))throw Error("first arg must be private key");if(!1===d(r))throw Error("second arg must be public key");let n=em(f,t);return e.fromHex(r).multiply(n).toBytes(i)},keygen:function(e){let t=s(e);return{secretKey:t,publicKey:c(t)}},Point:e,utils:{isValidSecretKey:o,isValidPublicKey:function(t,f){let{publicKey:r,publicKeyUncompressed:i}=n;try{let n=t.length;return(!0!==f||n===r)&&(!1!==f||n===i)&&!!e.fromBytes(t)}catch(e){return!1}},randomSecretKey:s,isValidPrivateKey:o,randomPrivateKey:s,normPrivateKeyToScalar:e=>em(f,e),precompute:(t=8,f=e.BASE)=>f.precompute(t,!1)},lengths:n})}(e,f),O={prehash:!1,lowS:"boolean"==typeof f.lowS&&f.lowS,format:void 0,extraEntropy:!1},A="compact";function S(e,t){if(!s.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class R{constructor(e,t,f){this.r=S("r",e),this.s=S("s",t),null!=f&&(this.recovery=f),Object.freeze(this)}static fromBytes(e,t=A){var f,r;let i,n;if(f=e,el(r=t),n=v.signature,a(f,"compact"===r?n:"recovered"===r?n+1:void 0,r+" signature"),"der"===t){let{r:t,s:f}=eh.toSig(a(e));return new R(t,f)}"recovered"===t&&(i=e[0],t="compact",e=e.subarray(1));let o=s.BYTES,c=e.subarray(0,o),d=e.subarray(o,2*o);return new R(s.fromBytes(c),s.fromBytes(d),i)}static fromHex(e,t){return this.fromBytes((0,i.h)(e),t)}addRecoveryBit(e){return new R(this.r,this.s,e)}recoverPublicKey(t){let f=o.ORDER,{r,s:n,recovery:a}=this;if(null==a||![0,1,2,3].includes(a))throw Error("recovery id invalid");if(c*ep<f&&a>1)throw Error("recovery id is ambiguous for h>1 curve");let d=2===a||3===a?r+c:r;if(!o.isValid(d))throw Error("recovery id 2 or 3 invalid");let l=o.toBytes(d),u=e.fromBytes((0,i.c)(ew(!(1&a)),l)),h=s.inv(d),b=U(g("msgHash",t)),p=s.create(-b*h),y=s.create(n*h),x=e.BASE.multiplyUnsafe(p).add(u.multiplyUnsafe(y));if(x.is0())throw Error("point at infinify");return x.assertValidity(),x}hasHighS(){return this.s>c>>eg}toBytes(e=A){if(el(e),"der"===e)return(0,i.h)(eh.hexFromSig(this));let t=s.toBytes(this.r),f=s.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw Error("recovery bit must be present");return(0,i.c)(Uint8Array.of(this.recovery),t,f)}return(0,i.c)(t,f)}toHex(e){return(0,i.b)(this.toBytes(e))}assertValidity(){}static fromCompact(e){return R.fromBytes(g("sig",e),"compact")}static fromDER(e){return R.fromBytes(g("sig",e),"der")}normalizeS(){return this.hasHighS()?new R(this.r,s.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,i.b)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,i.b)(this.toBytes("compact"))}}let F=f.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=l(e),f=8*e.length-d;return f>0?t>>BigInt(f):t},U=f.bits2int_modN||function(e){return s.create(F(e))},k=w(d);function L(e){return x("num < 2^"+d,e,eb,k),s.toBytes(e)}function H(e,f){return a(e,void 0,"message"),f?a(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:p,getPublicKey:y,getSharedSecret:m,utils:E,lengths:v,Point:e,sign:function(f,o,a={}){let{seed:d,k2sig:l}=function(t,f,n){if(["recovered","canonical"].some(e=>e in n))throw Error("sign() legacy options not supported");let{lowS:o,prehash:a,extraEntropy:d}=eu(n,O),l=U(t=H(t,a)),u=em(s,f),h=[L(u),L(l)];if(null!=d&&!1!==d){let e=!0===d?r(v.secretKey):d;h.push(g("extraEntropy",e))}return{seed:(0,i.c)(...h),k2sig:function(t){let f=F(t);if(!s.isValidNot0(f))return;let r=s.inv(f),i=e.BASE.multiply(f).toAffine(),n=s.create(i.x);if(n===eb)return;let a=s.create(r*s.create(l+n*u));if(a===eb)return;let d=2*(i.x!==n)|Number(i.y&eg),h=a;return o&&a>c>>eg&&(h=s.neg(a),d^=1),new R(n,h,d)}}}(f=g("message",f),o,a);return(function(e,t,f){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof f)throw Error("hmacFn must be a function");let r=e=>new Uint8Array(e),n=r(e),o=r(e),s=0,a=()=>{n.fill(1),o.fill(0),s=0},c=(...e)=>f(o,n,...e),d=(e=r(0))=>{o=c(Uint8Array.of(0),e),n=c(),0!==e.length&&(o=c(Uint8Array.of(1),e),n=c())},l=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let e=0,f=[];for(;e<t;){let t=(n=c()).slice();f.push(t),e+=n.length}return(0,i.c)(...f)};return(e,t)=>{let f;for(a(),d(e);!(f=t(l()));)d();return a(),f}})(t.outputLen,s.BYTES,n)(d,l)},verify:function(t,f,r,n={}){let{lowS:o,prehash:a,format:c}=eu(n,O);if(r=g("publicKey",r),f=H(g("message",f),a),"strict"in n)throw Error("options.strict was renamed to lowS");let d=void 0===c?function(e){let t,f="string"==typeof e||(0,i.i)(e),r=!f&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!f&&!r)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(r)t=new R(e.r,e.s);else if(f){try{t=R.fromBytes(g("sig",e),"der")}catch(e){if(!(e instanceof eh.Err))throw e}if(!t)try{t=R.fromBytes(g("sig",e),"compact")}catch(e){return!1}}return t||!1}(t):R.fromBytes(g("sig",t),c);if(!1===d)return!1;try{let t=e.fromBytes(r);if(o&&d.hasHighS())return!1;let{r:i,s:n}=d,a=U(f),c=s.inv(n),l=s.create(a*c),u=s.create(i*c),h=e.BASE.multiplyUnsafe(l).add(t.multiplyUnsafe(u));if(h.is0())return!1;return s.create(h.x)===i}catch(e){return!1}},recoverPublicKey:function(e,t,f={}){let{prehash:r}=eu(f,O);return t=H(t,r),R.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:R,hash:t})}(function(e,t={}){let f=ec("weierstrass",e,t),{Fp:r,Fn:n}=f,o=f.CURVE,{h:c,n:d}=o;B(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:l}=t;if(l&&(!r.is0(o.a)||"bigint"!=typeof l.beta||!Array.isArray(l.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let u=eB(r,n);function h(){if(!r.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let b=t.toBytes||function(e,t,f){let{x:n,y:o}=t.toAffine(),a=r.toBytes(n);if(s(f,"isCompressed"),f){h();let e=!r.isOdd(o);return(0,i.c)(ew(e),a)}return(0,i.c)(Uint8Array.of(4),a,r.toBytes(o))},p=t.fromBytes||function(e){a(e,void 0,"Point");let{publicKey:t,publicKeyUncompressed:f}=u,i=e.length,n=e[0],o=e.subarray(1);if(i!==t||2!==n&&3!==n){if(i===f&&4===n){let e=r.BYTES,t=r.fromBytes(o.subarray(0,e)),f=r.fromBytes(o.subarray(e,2*e));if(!x(t,f))throw Error("bad point: is not on curve");return{x:t,y:f}}throw Error(`bad point: got length ${i}, expected compressed=${t} or uncompressed=${f}`)}{let e,t=r.fromBytes(o);if(!r.isValid(t))throw Error("bad point: is not on curve, wrong x");let f=y(t);try{e=r.sqrt(f)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return h(),!(1&~n)!==r.isOdd(e)&&(e=r.neg(e)),{x:t,y:e}}};function y(e){let t=r.sqr(e),f=r.mul(t,e);return r.add(r.add(f,r.mul(e,o.a)),o.b)}function x(e,t){let f=r.sqr(t),i=y(e);return r.eql(f,i)}if(!x(o.Gx,o.Gy))throw Error("bad curve params: generator point");let v=r.mul(r.pow(o.a,ey),ex),I=r.mul(r.sqr(o.b),BigInt(27));if(r.is0(r.add(v,I)))throw Error("bad curve params: a or b");function O(e,t,f=!1){if(!r.isValid(t)||f&&r.is0(t))throw Error("bad point coordinate "+e);return t}function A(e){if(!(e instanceof k))throw Error("ProjectivePoint expected")}function S(e){if(!l||!l.basises)throw Error("no endo");return function(e,t,f){let[[r,i],[n,o]]=t,s=ed(o*e,f),a=ed(-i*e,f),c=e-s*r-a*n,d=-s*i-a*o,l=c<eb,u=d<eb;l&&(c=-c),u&&(d=-d);let h=w(Math.ceil(m(f)/2))+eg;if(c<eb||c>=h||d<eb||d>=h)throw Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:l,k1:c,k2neg:u,k2:d}}(e,l.basises,n.ORDER)}let R=E((e,t)=>{let{X:f,Y:i,Z:n}=e;if(r.eql(n,r.ONE))return{x:f,y:i};let o=e.is0();null==t&&(t=o?r.ONE:r.inv(n));let s=r.mul(f,t),a=r.mul(i,t),c=r.mul(n,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw Error("invZ was invalid");return{x:s,y:a}}),F=E(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.Y))return;throw Error("bad point: ZERO")}let{x:f,y:i}=e.toAffine();if(!r.isValid(f)||!r.isValid(i))throw Error("bad point: x or y not field elements");if(!x(f,i))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function U(e,t,f,i,n){return f=new k(r.mul(f.X,e),f.Y,f.Z),t=W(i,t),f=W(n,f),t.add(f)}class k{constructor(e,t,f){this.X=O("x",e),this.Y=O("y",t,!0),this.Z=O("z",f),Object.freeze(this)}static CURVE(){return o}static fromAffine(e){let{x:t,y:f}=e||{};if(!e||!r.isValid(t)||!r.isValid(f))throw Error("invalid affine point");if(e instanceof k)throw Error("projective point not allowed");return r.is0(t)&&r.is0(f)?k.ZERO:new k(t,f,r.ONE)}static fromBytes(e){let t=k.fromAffine(p(a(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return k.fromBytes(g("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return C.createCache(this,e),t||this.multiply(ey),this}assertValidity(){F(this)}hasEvenY(){let{y:e}=this.toAffine();if(!r.isOdd)throw Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){A(e);let{X:t,Y:f,Z:i}=this,{X:n,Y:o,Z:s}=e,a=r.eql(r.mul(t,s),r.mul(n,i)),c=r.eql(r.mul(f,s),r.mul(o,i));return a&&c}negate(){return new k(this.X,r.neg(this.Y),this.Z)}double(){let{a:e,b:t}=o,f=r.mul(t,ey),{X:i,Y:n,Z:s}=this,a=r.ZERO,c=r.ZERO,d=r.ZERO,l=r.mul(i,i),u=r.mul(n,n),h=r.mul(s,s),b=r.mul(i,n);return b=r.add(b,b),d=r.mul(i,s),d=r.add(d,d),a=r.mul(e,d),c=r.mul(f,h),c=r.add(a,c),a=r.sub(u,c),c=r.add(u,c),c=r.mul(a,c),a=r.mul(b,a),d=r.mul(f,d),h=r.mul(e,h),b=r.sub(l,h),b=r.mul(e,b),b=r.add(b,d),d=r.add(l,l),l=r.add(d,l),l=r.add(l,h),l=r.mul(l,b),c=r.add(c,l),h=r.mul(n,s),h=r.add(h,h),l=r.mul(h,b),a=r.sub(a,l),d=r.mul(h,u),d=r.add(d,d),new k(a,c,d=r.add(d,d))}add(e){A(e);let{X:t,Y:f,Z:i}=this,{X:n,Y:s,Z:a}=e,c=r.ZERO,d=r.ZERO,l=r.ZERO,u=o.a,h=r.mul(o.b,ey),b=r.mul(t,n),g=r.mul(f,s),p=r.mul(i,a),y=r.add(t,f),x=r.add(n,s);y=r.mul(y,x),x=r.add(b,g),y=r.sub(y,x),x=r.add(t,i);let m=r.add(n,a);return x=r.mul(x,m),m=r.add(b,p),x=r.sub(x,m),m=r.add(f,i),c=r.add(s,a),m=r.mul(m,c),c=r.add(g,p),m=r.sub(m,c),l=r.mul(u,x),c=r.mul(h,p),l=r.add(c,l),c=r.sub(g,l),l=r.add(g,l),d=r.mul(c,l),g=r.add(b,b),g=r.add(g,b),p=r.mul(u,p),x=r.mul(h,x),g=r.add(g,p),p=r.sub(b,p),p=r.mul(u,p),x=r.add(x,p),b=r.mul(g,x),d=r.add(d,b),b=r.mul(m,x),c=r.mul(y,c),c=r.sub(c,b),b=r.mul(y,g),l=r.mul(m,l),new k(c,d,l=r.add(l,b))}subtract(e){return this.add(e.negate())}is0(){return this.equals(k.ZERO)}multiply(e){let f,r,{endo:i}=t;if(!n.isValidNot0(e))throw Error("invalid scalar: out of range");let o=e=>C.cached(this,e,e=>J(k,e));if(i){let{k1neg:t,k1:n,k2neg:s,k2:a}=S(e),{p:c,f:d}=o(n),{p:l,f:u}=o(a);r=d.add(u),f=U(i.beta,c,l,t,s)}else{let{p:t,f:i}=o(e);f=t,r=i}return J(k,[f,r])[0]}multiplyUnsafe(e){let{endo:f}=t;if(!n.isValid(e))throw Error("invalid scalar: out of range");if(e===eb||this.is0())return k.ZERO;if(e===eg)return this;if(C.hasCache(this))return this.multiply(e);if(f){let{k1neg:t,k1:r,k2neg:i,k2:n}=S(e),{p1:o,p2:s}=function(e,t,f,r){let i=t,n=e.ZERO,o=e.ZERO;for(;f>M||r>M;)f&$&&(n=n.add(i)),r&$&&(o=o.add(i)),i=i.double(),f>>=$,r>>=$;return{p1:n,p2:o}}(k,this,r,n);return U(f.beta,o,s,t,i)}return C.unsafe(this,e)}multiplyAndAddUnsafe(e,t,f){let r=this.multiplyUnsafe(t).add(e.multiplyUnsafe(f));return r.is0()?void 0:r}toAffine(e){return R(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return c===eg||(e?e(k,this):C.unsafe(this,d).is0())}clearCofactor(){let{clearCofactor:e}=t;return c===eg?this:e?e(k,this):this.multiplyUnsafe(c)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}toBytes(e=!0){return s(e,"isCompressed"),this.assertValidity(),b(k,this,e)}toHex(e=!0){return(0,i.b)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return J(k,e)}static msm(e,t){return es(k,n,e,t)}static fromPrivateKey(e){return k.BASE.multiply(em(n,e))}}k.BASE=new k(o.Gx,o.Gy,r.ONE),k.ZERO=new k(r.ZERO,r.ONE,r.ZERO),k.Fp=r,k.Fn=n;let L=n.BITS,C=new eo(k,t.endo?Math.ceil(L/2):L);return k.BASE.precompute(8),k}(r,n),o,c)).Point,Object.assign({},t,{ProjectivePoint:f,CURVE:Object.assign({},e,_(f.Fn.ORDER,f.Fn.BITS))})})({...e,hash:t});return{...f(t),create:f}}let ev={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},eI={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},eO={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},eA=j(ev.p),eS=j(eI.p),eR=j(eO.p),eF=eE({...ev,Fp:eA,lowS:!1},i.s),eU=eE({...eI,Fp:eS,lowS:!1},i.j),ek=eE({...eO,Fp:eR,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},i.k),eL=BigInt(0),eC=BigInt(1),eH=BigInt(2),eN=BigInt(8);function eq(e,t={}){var f,r;let n,o,c,d,l,h=ec("edwards",e,t,t.FpFnLE),{Fp:b,Fn:y}=h,m=h.CURVE,{h:w}=m;B(t,{},{uvRatio:"function"});let v=eH<<BigInt(8*y.BYTES)-eC,I=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:b.sqrt(b.div(e,t))}}catch(e){return{isValid:!1,value:eL}}});if(f=m.Gx,r=m.Gy,n=b.sqr(f),o=b.sqr(r),c=b.add(b.mul(m.a,n),o),d=b.add(b.ONE,b.mul(m.d,b.mul(n,o))),!b.eql(c,d))throw Error("bad curve params: generator point");function O(e,t,f=!1){return x("coordinate "+e,t,f?eC:eL,v),t}function A(e){if(!(e instanceof F))throw Error("ExtendedPoint expected")}let S=E((e,t)=>{let f,r,{X:i,Y:n,Z:o}=e,s=e.is0();null==t&&(t=s?eN:b.inv(o));let a=(f=i*t,b.create(f)),c=(r=n*t,b.create(r)),d=b.mul(o,t);if(s)return{x:eL,y:eC};if(d!==eC)throw Error("invZ was invalid");return{x:a,y:c}}),R=E(e=>{let t,f,r,i,n,o,s,a,c,d,l,u,{a:h,d:g}=m;if(e.is0())throw Error("bad point: ZERO");let{X:p,Y:y,Z:x,T:w}=e,B=(t=p*p,b.create(t)),E=(f=y*y,b.create(f)),v=(r=x*x,b.create(r)),I=(i=v*v,b.create(i));if(s=v*(n=B*h,o=b.create(n)+E,b.create(o)),b.create(s)!==(d=I+(c=g*(a=B*E,b.create(a)),b.create(c)),b.create(d)))throw Error("bad point: equation left != right (1)");if(l=p*y,b.create(l)!==(u=x*w,b.create(u)))throw Error("bad point: equation left != right (2)");return!0});class F{constructor(e,t,f,r){this.X=O("x",e),this.Y=O("y",t),this.Z=O("z",f,!0),this.T=O("t",r),Object.freeze(this)}static CURVE(){return m}static fromAffine(e){let t;if(e instanceof F)throw Error("extended point not allowed");let{x:f,y:r}=e||{};return O("x",f),O("y",r),new F(f,r,eC,(t=f*r,b.create(t)))}static fromBytes(e,t=!1){let f,r,i,n,o=b.BYTES,{a:c,d:d}=m;e=p(a(e,o,"point")),s(t,"zip215");let l=p(e),h=e[o-1];l[o-1]=-129&h;let g=u(l);x("point.y",g,eL,t?v:b.ORDER);let y=(f=g*g,b.create(f)),{isValid:w,value:B}=I((r=y-eC,b.create(r)),(i=d*y-c,b.create(i)));if(!w)throw Error("bad point: invalid y coordinate");let E=(B&eC)===eC,O=!!(128&h);if(!t&&B===eL&&O)throw Error("bad point: x=0 and x_0=1");return O!==E&&(n=-B,B=b.create(n)),F.fromAffine({x:B,y:g})}static fromHex(e,t=!1){return F.fromBytes(g("point",e),t)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return U.createCache(this,e),t||this.multiply(eH),this}assertValidity(){R(this)}equals(e){let t,f,r,i;A(e);let{X:n,Y:o,Z:s}=this,{X:a,Y:c,Z:d}=e,l=(t=n*d,b.create(t)),u=(f=a*s,b.create(f)),h=(r=o*d,b.create(r)),g=(i=c*s,b.create(i));return l===u&&h===g}is0(){return this.equals(F.ZERO)}negate(){let e,t;return new F((e=-this.X,b.create(e)),this.Y,this.Z,(t=-this.T,b.create(t)))}double(){let e,t,f,r,i,n,o,s,a,c,d,{a:l}=m,{X:u,Y:h,Z:g}=this,p=(e=u*u,b.create(e)),y=(t=h*h,b.create(t)),x=(r=eH*(f=g*g,b.create(f)),b.create(r)),w=(i=l*p,b.create(i)),B=u+h,E=(n=B*B,o=b.create(n)-p-y,b.create(o)),v=w+y,I=v-x,O=w-y,A=(s=E*I,b.create(s)),S=(a=v*O,b.create(a)),R=(c=E*O,b.create(c));return new F(A,S,(d=I*v,b.create(d)),R)}add(e){let t,f,r,i,n,o,s,a,c,d;A(e);let{a:l,d:u}=m,{X:h,Y:g,Z:p,T:y}=this,{X:x,Y:w,Z:B,T:E}=e,v=(t=h*x,b.create(t)),I=(f=g*w,b.create(f)),O=(r=y*u*E,b.create(r)),S=(i=p*B,b.create(i)),R=(n=(h+g)*(x+w)-v-I,b.create(n)),U=S-O,k=S+O,L=(o=I-l*v,b.create(o)),C=(s=R*U,b.create(s)),H=(a=k*L,b.create(a)),N=(c=R*L,b.create(c));return new F(C,H,(d=U*k,b.create(d)),N)}subtract(e){return this.add(e.negate())}multiply(e){if(!y.isValidNot0(e))throw Error("invalid scalar: expected 1 <= sc < curve.n");let{p:t,f}=U.cached(this,e,e=>J(F,e));return J(F,[t,f])[0]}multiplyUnsafe(e,t=F.ZERO){if(!y.isValid(e))throw Error("invalid scalar: expected 0 <= sc < curve.n");return e===eL?F.ZERO:this.is0()||e===eC?this:U.unsafe(this,e,e=>J(F,e),t)}isSmallOrder(){return this.multiplyUnsafe(w).is0()}isTorsionFree(){return U.unsafe(this,m.n).is0()}toAffine(e){return S(this,e)}clearCofactor(){return w===eC?this:this.multiplyUnsafe(w)}toBytes(){let{x:e,y:t}=this.toAffine(),f=b.toBytes(t);return f[f.length-1]|=e&eC?128:0,f}toHex(){return(0,i.b)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(e){return J(F,e)}static msm(e,t){return es(F,y,e,t)}_setWindowSize(e){this.precompute(e)}toRawBytes(){return this.toBytes()}}F.BASE=new F(m.Gx,m.Gy,eC,(l=m.Gx*m.Gy,b.create(l))),F.ZERO=new F(eL,eC,eC,eL),F.Fp=b,F.Fn=y;let U=new eo(F,y.BITS);return F.BASE.precompute(8),F}let eZ=BigInt(0),eV=BigInt(1),eP=BigInt(2),eK={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},eG=Object.assign({},eK,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),eT=(0,i.l)(()=>i.m.create({dkLen:114})),e_=BigInt(1),ej=BigInt(2),eD=BigInt(3);BigInt(4);let eY=BigInt(11),ez=BigInt(22),eX=BigInt(44),eM=BigInt(88),e$=BigInt(223);function eW(e){let t=eK.p,f=e*e*e%t,r=f*f*e%t,i=H(r,eD,t)*r%t,n=H(i,eD,t)*r%t,o=H(n,ej,t)*f%t,s=H(o,eY,t)*o%t,a=H(s,ez,t)*s%t,c=H(a,eX,t)*a%t,d=H(c,eM,t)*c%t,l=H(d,eX,t)*a%t,u=H(l,ej,t)*f%t,h=H(u,e_,t)*e%t;return H(h,e$,t)*u%t}function eJ(e){return e[0]&=252,e[55]|=128,e[56]=0,e}let eQ=j(eK.p,{BITS:456,isLE:!0}),e0=j(eK.n,{BITS:456,isLE:!0}),e1=function(e){var t;let f,r,n,o,{CURVE:c,curveOpts:d,hash:l,eddsaOpts:h}=(f={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r={Fp:e.Fp,Fn:j(f.n,e.nBitLength,!0),uvRatio:e.uvRatio},n={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve},{CURVE:f,curveOpts:r,hash:e.hash,eddsaOpts:n});return o=(t=function(e,t,f={}){if("function"!=typeof t)throw Error('"hash" function param is required');B(f,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:r}=f,{BASE:n,Fp:o,Fn:c}=e,d=f.randomBytes||i.r,l=f.adjustScalarBytes||(e=>e),h=f.domain||((e,t,f)=>{if(s(f,"phflag"),t.length||f)throw Error("Contexts/pre-hash are not supported");return e});function b(e){return c.create(u(e))}function p(e){var f;let r,i,o,{head:s,prefix:a,scalar:c}=(f=g("private key",f=e,r=E.secretKey),{head:o=l((i=g("hashed private key",t(f),2*r)).slice(0,r)),prefix:i.slice(r,2*r),scalar:b(o)}),d=n.multiply(c),u=d.toBytes();return{head:s,prefix:a,scalar:c,point:d,pointBytes:u}}function y(e){return p(e).pointBytes}function x(e=Uint8Array.of(),...f){return b(t(h((0,i.c)(...f),g("context",e),!!r)))}let m={zip215:!0},w=o.BYTES,E={secretKey:w,publicKey:w,signature:2*w,seed:w};function v(e=d(E.seed)){return a(e,E.seed,"seed")}let I={getExtendedPublicKey:p,randomSecretKey:v,isValidSecretKey:function(e){return(0,i.i)(e)&&e.length===c.BYTES},isValidPublicKey:function(t,f){try{return!!e.fromBytes(t,f)}catch(e){return!1}},toMontgomery(t){let{y:f}=e.fromBytes(t),r=E.publicKey,i=32===r;if(!i&&57!==r)throw Error("only defined for 25519 and 448");let n=i?o.div(eC+f,eC-f):o.div(f-eC,f+eC);return o.toBytes(n)},toMontgomeryPriv(e){let f=E.secretKey;return a(e,f),l(t(e.subarray(0,f))).subarray(0,f)},randomPrivateKey:v,precompute:(t=8,f=e.BASE)=>f.precompute(t,!1)};return Object.freeze({keygen:function(e){let t=I.randomSecretKey(e);return{secretKey:t,publicKey:y(t)}},getPublicKey:y,sign:function(e,t,f={}){e=g("message",e),r&&(e=r(e));let{prefix:o,scalar:s,pointBytes:d}=p(t),l=x(f.context,o,e),u=n.multiply(l).toBytes(),h=x(f.context,u,d,e),b=c.create(l+h*s);if(!c.isValid(b))throw Error("sign failed: invalid s");return a((0,i.c)(u,c.toBytes(b)),E.signature,"result")},verify:function(t,f,i,o=m){let a,c,d,{context:l,zip215:h}=o,b=E.signature;t=g("signature",t,b),f=g("message",f),i=g("publicKey",i,E.publicKey),void 0!==h&&s(h,"zip215"),r&&(f=r(f));let p=b/2,y=t.subarray(0,p),w=u(t.subarray(p,b));try{a=e.fromBytes(i,h),c=e.fromBytes(y,h),d=n.multiplyUnsafe(w)}catch(e){return!1}if(!h&&a.isSmallOrder())return!1;let B=x(l,c.toBytes(),a.toBytes(),f);return c.add(a.multiplyUnsafe(B)).subtract(d).clearCofactor().is0()},utils:I,Point:e,lengths:E})}(eq(c,d),l,h)).Point,Object.assign({},t,{ExtendedPoint:o,CURVE:e,nBitLength:o.Fn.BITS,nByteLength:o.Fn.BYTES})}({...eK,Fp:eQ,Fn:e0,nBitLength:e0.BITS,hash:eT,adjustScalarBytes:eJ,domain:function(e,t,f){var r;if(t.length>255)throw Error("context must be smaller than 255, got: "+t.length);return(0,i.c)((r="SigEd448",Uint8Array.from(r,(e,t)=>{let f=e.charCodeAt(0);if(1!==e.length||f>127)throw Error(`string contains non-ASCII character "${r[t]}" with code ${f} at position ${t}`);return f})),new Uint8Array([+!!f,t.length]),t,e)},uvRatio:function(e,t){let f=eK.p,r=C(e*e*t,f),i=C(r*e,f),n=C(i*r*t,f),o=C(i*eW(n),f),s=C(o*o,f);return{isValid:C(s*t,f)===e,value:o}}});eq(eG);let e2=function(e){let{P:t,type:f,adjustScalarBytes:r,powPminus2:n,randomBytes:o}=(B(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})),s="x25519"===f;if(!s&&"x448"!==f)throw Error("invalid type");let a=o||i.r,c=s?255:448,d=s?32:56,l=s?BigInt(9):BigInt(5),h=s?BigInt(121665):BigInt(39081),p=s?eP**BigInt(254):eP**BigInt(447),y=p+(s?BigInt(8)*eP**BigInt(251)-eV:BigInt(4)*eP**BigInt(445)-eV)+eV,m=e=>C(e,t),w=b(m(l),d);function E(e,f){let i,o=function(e,f){x("u",e,eZ,t),x("scalar",f,p,y);let r=eV,i=eZ,o=e,s=eV,a=eZ;for(let t=BigInt(c-1);t>=eZ;t--){let n=f>>t&eV;a^=n,({x_2:r,x_3:o}=I(a,r,o)),({x_2:i,x_3:s}=I(a,i,s)),a=n;let c=r+i,d=m(c*c),l=r-i,u=m(l*l),b=d-u,g=o+s,p=m((o-s)*c),y=m(g*l),x=p+y,w=p-y;o=m(x*x),s=m(e*m(w*w)),r=m(d*u),i=m(b*(d+m(h*b)))}return{x_2:r,x_3:o}=I(a,r,o),{x_2:i,x_3:s}=I(a,i,s),m(r*n(i))}((i=g("u coordinate",f,d),s&&(i[31]&=127),m(u(i))),u(r(g("scalar",e,d))));if(o===eZ)throw Error("invalid private or public key received");return b(m(o),d)}function v(e){return E(e,w)}function I(e,t,f){let r=m(e*(t-f));return{x_2:t=m(t-r),x_3:f=m(f+r)}}let O={secretKey:d,publicKey:d,seed:d},A=(e=a(d))=>((0,i.a)(e,O.seed),e);return{keygen:function(e){let t=A(e);return{secretKey:t,publicKey:v(t)}},getSharedSecret:(e,t)=>E(e,t),getPublicKey:e=>v(e),scalarMult:E,scalarMultBase:v,utils:{randomSecretKey:A,randomPrivateKey:A},GuBytes:w.slice(),lengths:O}}({P:r=eK.p,type:"x448",powPminus2:e=>C(H(eW(e),ej,r)*e,r),adjustScalarBytes:eJ}),e8={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},e3={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},e4=BigInt(2),e6=j(e8.p,{sqrt:function(e){let t=e8.p,f=BigInt(3),r=BigInt(6),i=BigInt(11),n=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),c=e*e*e%t,d=c*c*e%t,l=H(d,f,t)*d%t,u=H(l,f,t)*d%t,h=H(u,e4,t)*c%t,b=H(h,i,t)*h%t,g=H(b,n,t)*b%t,p=H(g,s,t)*g%t,y=H(p,a,t)*p%t,x=H(y,s,t)*g%t,m=H(x,f,t)*d%t,w=H(m,o,t)*b%t,B=H(w,r,t)*c%t,E=H(B,e4,t);if(!e6.eql(e6.sqr(E),e))throw Error("Cannot find square root");return E}}),e7=eE({...e8,Fp:e6,lowS:!0,endo:e3},i.s),e5=j(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),e9=eE({a:e5.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:e5,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},i.n),te=j(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),tt=eE({a:te.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:te,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},i.o),tf=j(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),tr=new Map(Object.entries({nistP256:eF,nistP384:eU,nistP521:ek,brainpoolP256r1:e9,brainpoolP384r1:tt,brainpoolP512r1:eE({a:tf.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:tf,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},i.p),secp256k1:e7,x448:e2,ed448:e1}))}}]);
