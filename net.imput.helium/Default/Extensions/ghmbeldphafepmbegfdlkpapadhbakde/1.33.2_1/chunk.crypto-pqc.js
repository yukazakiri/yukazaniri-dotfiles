"use strict";(self.webpackChunkproton_pass_extension=self.webpackChunkproton_pass_extension||[]).push([["node_modules_openpgp_dist_lightweight_noble_post_quantum_min_mjs"],{9891:(e,t,r)=>{r.d(t,{ml_dsa65:()=>ep,ml_kem768:()=>J});let n="undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{};function o(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function l(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function i(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}let s=BigInt(0x100000000-1),u=BigInt(32),d="object"==typeof n&&"crypto"in n?n.crypto:void 0,f=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),c=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function a(e){var t;for(let r=0;r<e.length;r++)e[r]=(t=e[r])<<24&0xff000000|t<<8&0xff0000|t>>>8&65280|t>>>24&255}function h(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),l(e),e}class p{clone(){return this._cloneInto()}}let y=[],g=[],b=[],w=BigInt(0),A=BigInt(1),L=BigInt(2),k=BigInt(7),m=BigInt(256),E=BigInt(113);for(let e=0,t=A,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],y.push(2*(5*n+r)),g.push((e+1)*(e+2)/2%64);let o=w;for(let e=0;e<7;e++)(t=(t<<A^(t>>k)*E)%m)&L&&(o^=A<<(A<<BigInt(e))-A);b.push(o)}let[T,U]=function(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:l,l:i}=function(e,t=!1){return t?{h:Number(e&s),l:Number(e>>u&s)}:{h:0|Number(e>>u&s),l:0|Number(e&s)}}(e[o],t);[r[o],n[o]]=[l,i]}return[r,n]}(b,!0),I=(e,t,r)=>r>32?t<<r-32|e>>>64-r:e<<r|t>>>32-r,O=(e,t,r)=>r>32?e<<r-32|t>>>64-r:t<<r|e>>>32-r;class _ extends p{constructor(e,t,r,n=!1,l=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=l,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,o(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=f(this.state)}keccak(){c||a(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let n=(t+8)%10,o=(t+2)%10,l=r[o],i=r[o+1],s=I(l,i,1)^r[n],u=O(l,i,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=s,e[t+r+1]^=u}let t=e[2],o=e[3];for(let r=0;r<24;r++){let n=g[r],l=I(t,o,n),i=O(t,o,n),s=y[r];t=e[s],o=e[s+1],e[s]=l,e[s+1]=i}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=T[n],e[1]^=U[n]}r.fill(0)}(this.state32,this.rounds),c||a(this.state32),this.posOut=0,this.pos=0}update(e){i(this);let{blockLen:t,state:r}=this,n=(e=h(e)).length;for(let o=0;o<n;){let l=Math.min(t-this.pos,n-o);for(let t=0;t<l;t++)r[this.pos++]^=e[o++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){i(this,!1),l(e),this.finish();let t=this.state,{blockLen:r}=this;for(let n=0,o=e.length;n<o;){this.posOut>=r&&this.keccak();let l=Math.min(r-this.posOut,o-n);e.set(t.subarray(this.posOut,this.posOut+l),n),this.posOut+=l,n+=l}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return o(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(function(e,t){l(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:n,rounds:o,enableXOF:l}=this;return e||(e=new _(t,r,n,l,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=n,e.enableXOF=l,e.destroyed=this.destroyed,e}}let B=(e,t,r)=>{var n;let o,l;return n=()=>new _(t,e,r),(o=e=>n().update(h(e)).digest()).outputLen=(l=n()).outputLen,o.blockLen=l.blockLen,o.create=()=>n(),o},x=B(6,136,32),K=B(6,72,64),M=(e,t,r)=>{var n;let o,l;return n=(n={})=>new _(t,e,void 0===n.dkLen?r:n.dkLen,!0),(o=(e,t)=>n(t).update(h(e)).digest()).outputLen=(l=n({})).outputLen,o.blockLen=l.blockLen,o.create=e=>n(e),o},v=M(31,168,16),F=M(31,136,32),N=function(e=32){if(d&&"function"==typeof d.getRandomValues)return d.getRandomValues(new Uint8Array(e));if(d&&"function"==typeof d.randomBytes)return d.randomBytes(e);throw Error("crypto.getRandomValues must be defined")};function S(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}function R(...e){let t=e=>"number"==typeof e?e:e.bytesLen,r=e.reduce((e,r)=>e+t(r),0);return{bytesLen:r,encode:n=>{let o=new Uint8Array(r);for(let r=0,i=0;r<e.length;r++){let s=e[r],u=t(s),d="number"==typeof s?n[r]:s.encode(n[r]);l(d,u),o.set(d,i),"number"!=typeof s&&d.fill(0),i+=u}return o},decode:n=>{l(n,r);let o=[];for(let r of e){let e=t(r),l=n.subarray(0,e);o.push("number"==typeof r?l:r.decode(l)),n=n.subarray(e)}return o}}}function H(e,t){let r=t*e.bytesLen;return{bytesLen:r,encode:n=>{if(n.length!==t)throw Error(`vecCoder.encode: wrong length=${n.length}. Expected: ${t}`);let o=new Uint8Array(r);for(let t=0,r=0;t<n.length;t++){let l=e.encode(n[t]);o.set(l,r),l.fill(0),r+=l.length}return o},decode:t=>{l(t,r);let n=[];for(let r=0;r<t.length;r+=e.bytesLen)n.push(e.decode(t.subarray(r,r+e.bytesLen)));return n}}}function C(...e){for(let t of e)if(Array.isArray(t))for(let e of t)e.fill(0);else t.fill(0)}let X=e=>{let{newPoly:t,N:r,Q:n,F:o,ROOT_OF_UNITY:l,brvBits:i,isKyber:s}=e,u=(e,t=n)=>{let r=e%t|0;return 0|(r>=0?r:t+r)},d=function(){let e=t(r);for(let t=0;t<r;t++){let r=function(e,t=8){return Number.parseInt(e.toString(2).padStart(8,"0").slice(-t).padStart(7,"0").split("").reverse().join(""),2)}(t,i),o=BigInt(l)**BigInt(r)%BigInt(n);e[t]=0|Number(o)}return e}(),f=s?128:r,c=+!!s;return{mod:u,smod:(e,t=n)=>{let r=0|u(e,t);return 0|(r>t>>1?r-t:r)},nttZetas:d,NTT:{encode:e=>{for(let t=1,n=128;n>c;n>>=1)for(let o=0;o<r;o+=2*n){let r=d[t++];for(let t=o;t<o+n;t++){let o=u(r*e[t+n]);e[t+n]=0|u(e[t]-o),e[t]=0|u(e[t]+o)}}return e},decode:e=>{for(let t=f-1,n=1+c;n<f+c;n<<=1)for(let o=0;o<r;o+=2*n){let r=d[t--];for(let t=o;t<o+n;t++){let o=e[t];e[t]=u(o+e[t+n]),e[t+n]=u(r*(e[t+n]-o))}}for(let t=0;t<e.length;t++)e[t]=u(o*e[t]);return e}},bitsCoder:(e,n)=>{let o=(1<<e)-1,l=r/8*e;return{bytesLen:l,encode:t=>{let r=new Uint8Array(l);for(let l=0,i=0,s=0,u=0;l<t.length;l++)for(i|=(n.encode(t[l])&o)<<s,s+=e;s>=8;s-=8,i>>=8)r[u++]=i&(1<<s)-1;return r},decode:l=>{let i=t(r);for(let t=0,r=0,s=0,u=0;t<l.length;t++)for(r|=l[t]<<s,s+=8;s>=e;s-=e,r>>=e)i[u++]=n.decode(r&o);return i}}}}},G=e=>(t,r)=>{r||(r=e.blockLen);let n=new Uint8Array(t.length+2);n.set(t);let o=t.length,l=new Uint8Array(r),i=e.create({}),s=0,u=0;return{stats:()=>({calls:s,xofs:u}),get:(t,r)=>(n[o+0]=t,n[o+1]=r,i.destroy(),i=e.create({}).update(n),s++,()=>(u++,i.xofInto(l))),clean:()=>{i.destroy(),l.fill(0),n.fill(0)}}},Y=G(v),D=G(F),{mod:P,nttZetas:$,NTT:j,bitsCoder:Q}=X({N:256,Q:3329,F:3303,ROOT_OF_UNITY:17,newPoly:e=>new Uint16Array(e),brvBits:7,isKyber:!0}),V=e=>Q(e,(e=>{if(e>=12)return{encode:e=>e,decode:e=>e};let t=2**(e-1);return{encode:t=>((t<<e)+1664.5)/3329,decode:r=>3329*r+t>>>e}})(e));function W(e,t){for(let r=0;r<256;r++)e[r]=P(e[r]+t[r])}function Z(e,t){var r,n,o,l;for(let i=0;i<128;i++){let s=$[64+(i>>1)];1&i&&(s=-s);let{c0:u,c1:d}=(r=e[2*i+0],n=e[2*i+1],o=t[2*i+0],{c0:P(n*(l=t[2*i+1])*s+r*o),c1:P(r*l+n*o)});e[2*i+0]=u,e[2*i+1]=d}return e}function q(e){let t=new Uint16Array(256);for(let r=0;r<256;){let n=e();if(n.length%3)throw Error("SampleNTT: unaligned block");for(let e=0;r<256&&e+3<=n.length;e+=3){let o=4095&(n[e+0]|n[e+1]<<8),l=4095&(n[e+1]>>4|n[e+2]<<4);o<3329&&(t[r++]=o),r<256&&l<3329&&(t[r++]=l)}}return t}function z(e,t,r,n){let o=e(256*n/4,t,r),l=new Uint16Array(256),i=f(o),s=0;for(let e=0,t=0,r=0,o=0;e<i.length;e++){let u=i[e];for(let e=0;e<32;e++)r+=1&u,u>>=1,(s+=1)===n?(o=r,r=0):s===2*n&&(l[t++]=P(o-r),r=0,s=0)}if(s)throw Error("sampleCBD: leftover bits: "+s);return l}let J=function(e){let t=(e=>{let{K:t,PRF:r,XOF:n,HASH512:o,ETA1:l,ETA2:i,du:s,dv:u}=e,d=V(1),f=V(u),c=V(s),a=R(H(V(12),t),32),h=H(V(12),t),p=R(H(c,t),f),y=R(32,32);return{secretCoder:h,secretKeyLen:h.bytesLen,publicKeyLen:a.bytesLen,cipherTextLen:p.bytesLen,keygen:e=>{let i=new Uint8Array(33);i.set(e),i[32]=t;let s=o(i),[u,d]=y.decode(s),f=[],c=[];for(let e=0;e<t;e++)f.push(j.encode(z(r,d,e,l)));let p=n(u);for(let e=0;e<t;e++){let n=j.encode(z(r,d,t+e,l));for(let r=0;r<t;r++)W(n,Z(q(p.get(r,e)),f[r]));c.push(n)}p.clean();let g={publicKey:a.encode([c,u]),secretKey:h.encode(f)};return C(u,d,f,c,i,s),g},encrypt:(e,o,s)=>{let[u,f]=a.decode(e),c=[];for(let e=0;e<t;e++)c.push(j.encode(z(r,s,e,l)));let h=n(f),y=new Uint16Array(256),g=[];for(let e=0;e<t;e++){let n=z(r,s,t+e,i),o=new Uint16Array(256);for(let r=0;r<t;r++)W(o,Z(q(h.get(e,r)),c[r]));W(n,j.decode(o)),g.push(n),W(y,Z(u[e],c[e])),o.fill(0)}h.clean();let b=z(r,s,2*t,i);W(b,j.decode(y));let w=d.decode(o);return W(w,b),C(u,c,y,b),p.encode([g,w])},decrypt:(e,r)=>{let[n,o]=p.decode(e),l=h.decode(r),i=new Uint16Array(256);for(let e=0;e<t;e++)W(i,Z(l[e],j.encode(n[e])));return function(e,t){for(let r=0;r<256;r++)e[r]=P(e[r]-t[r])}(o,j.decode(i)),C(i,l,n),d.encode(o)}}})(e),{HASH256:r,HASH512:n,KDF:o}=e,{secretCoder:i,cipherTextLen:s}=t,u=t.publicKeyLen,d=R(t.secretKeyLen,t.publicKeyLen,32,32),f=d.bytesLen;return{publicKeyLen:u,msgLen:32,keygen:(e=N(64))=>{l(e,64);let{publicKey:n,secretKey:o}=t.keygen(e.subarray(0,32)),i=r(n),s=d.encode([o,n,i,e.subarray(32)]);return C(o,i),{publicKey:n,secretKey:s}},encapsulate:(o,s=N(32))=>{l(o,u),l(s,32);let d=o.subarray(0,384*e.K),f=i.encode(i.decode(d.slice()));if(!S(f,d))throw C(f),Error("ML-KEM.encapsulate: wrong publicKey modulus");C(f);let c=n.create().update(s).update(r(o)).digest(),a=t.encrypt(o,s,c.subarray(32,64));return c.subarray(32).fill(0),{cipherText:a,sharedSecret:c.subarray(0,32)}},decapsulate:(e,r)=>{l(r,f),l(e,s);let[i,u,c,a]=d.decode(r),h=t.decrypt(e,i),p=n.create().update(h).update(c).digest(),y=p.subarray(0,32),g=t.encrypt(u,h,p.subarray(32,64)),b=S(e,g),w=o.create({dkLen:32}).update(a).update(e).digest();return C(h,g,b?w:y),b?y:w}}}({HASH256:x,HASH512:K,KDF:F,XOF:Y,PRF:function(e,t,r){return F.create({dkLen:e}).update(t).update(new Uint8Array([r])).digest()},N:256,Q:3329,K:3,ETA1:2,ETA2:2,du:10,dv:4,RBGstrength:192}),ee=e=>new Int32Array(e),{mod:et,smod:er,NTT:en,bitsCoder:eo}=X({N:256,Q:8380417,F:8347681,ROOT_OF_UNITY:1753,newPoly:ee,isKyber:!1,brvBits:8}),el=e=>e,ei=(e,t=el,r=el)=>eo(e,{encode:e=>t(r(e)),decode:e=>r(t(e))}),es=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=et(e[r]+t[r]);return e},eu=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=et(e[r]-t[r]);return e},ed=e=>{for(let t=0;t<256;t++)e[t]<<=13;return e},ef=(e,t)=>{for(let r=0;r<256;r++)if(Math.abs(er(e[r]))>=t)return!0;return!1},ec=(e,t)=>{let r=ee(256);for(let n=0;n<e.length;n++)r[n]=et(e[n]*t[n]);return r};function ea(e){let t=ee(256);for(let r=0;r<256;){let n=e();if(n.length%3)throw Error("RejNTTPoly: unaligned block");for(let e=0;r<256&&e<=n.length-3;e+=3){let o=8388607&(n[e+0]|n[e+1]<<8|n[e+2]<<16);o<8380417&&(t[r++]=o)}}return t}let eh=new Uint8Array(0),ep=function(e){let{K:t,L:r,GAMMA1:n,GAMMA2:o,TAU:i,ETA:s,OMEGA:u}=e,{CRH_BYTES:d,TR_BYTES:f,C_TILDE_BYTES:c,XOF128:a,XOF256:h}=e;if(![2,4].includes(s))throw Error("Wrong ETA");if(![131072,524288].includes(n))throw Error("Wrong GAMMA1");if(![95232,261888].includes(o))throw Error("Wrong GAMMA2");let p=i*s,y=e=>{let t=et(e),r=0|er(t,2*o);return t-r==8380416?{r1:0,r0:r-1|0}:{r1:0|Math.floor((t-r)/(2*o)),r0:r}},g=e=>y(e).r1,b=e=>y(e).r0,w=(e,t)=>{let r=Math.floor(8380416/(2*o)),{r1:n,r0:l}=y(t);return 1===e?l>0?0|et(n+1,r):0|et(n-1,r):0|n},A=e=>{let t=et(e),r=0|er(t,8192);return{r1:0|Math.floor((t-r)/8192),r0:r}},L=ei(2===s?3:4,e=>s-e,e=>{if(!(-s<=e&&e<=s))throw Error(`malformed key s1/s3 ${e} outside of ETA range [${-s}, ${s}]`);return e}),k=ei(13,e=>4096-e),m=ei(10),E=ei(131072===n?18:20,e=>er(n-e)),T=H(ei(95232===o?6:4),t),U=R(32,H(m,t)),I=R(32,32,f,H(L,r),H(L,t),H(k,t)),O=R(c,H(E,r),{bytesLen:u+t,encode:e=>{if(!1===e)throw Error("hint.encode: hint is false");let r=new Uint8Array(u+t);for(let n=0,o=0;n<t;n++){for(let t=0;t<256;t++)0!==e[n][t]&&(r[o++]=t);r[u+n]=o}return r},decode:e=>{let r=[],n=0;for(let o=0;o<t;o++){let t=ee(256);if(e[u+o]<n||e[u+o]>u)return!1;for(let r=n;r<e[u+o];r++){if(r>n&&e[r]<=e[r-1])return!1;t[e[r]]=1}n=e[u+o],r.push(t)}for(let t=n;t<u;t++)if(0!==e[t])return!1;return r}}),_=2===s?e=>e<15&&2-e%5:e=>e<9&&4-e;function B(e){let t=ee(256);for(let r=0;r<256;){let n=e();for(let e=0;r<256&&e<n.length;e+=1){let o=_(15&n[e]),l=_(n[e]>>4&15);!1!==o&&(t[r++]=o),r<256&&!1!==l&&(t[r++]=l)}}return t}let x=e=>{let t=ee(256),r=F.create({}).update(e),n=new Uint8Array(F.blockLen);r.xofInto(n);let o=n.slice(0,8);for(let e=256-i,l=8,s=0,u=0;e<256;e++){let i=e+1;for(;i>e;)i=n[l++],l<F.blockLen||(r.xofInto(n),l=0);t[e]=t[i],t[i]=1-((o[s]>>u++&1)<<1),u>=8&&(s++,u=0)}return t},K=e=>{let t=ee(256),r=ee(256);for(let n=0;n<e.length;n++){let{r0:o,r1:l}=A(e[n]);t[n]=o,r[n]=l}return{r0:t,r1:r}},M=(e,t)=>{for(let r=0;r<256;r++)e[r]=w(t[r],e[r]);return e},v=(e,t)=>{var r,n;let l=ee(256),i=0;for(let s=0;s<256;s++){let u=(r=e[s],n=t[s],r<=o||r>8380417-o||r===8380417-o&&0===n?0:1);l[s]=u,i+=u}return{v:l,cnt:i}},X=R(32,64,32),G={signRandBytes:32,keygen:(e=N(32))=>{let n=new Uint8Array(34);n.set(e),n[32]=t,n[33]=r;let[o,l,i]=X.decode(F(n,{dkLen:X.bytesLen})),s=h(l),u=[];for(let e=0;e<r;e++)u.push(B(s.get(255&e,e>>8&255)));let d=[];for(let e=r;e<r+t;e++)d.push(B(s.get(255&e,e>>8&255)));let c=u.map(e=>en.encode(e.slice())),p=[],y=[],g=a(o),b=ee(256);for(let e=0;e<t;e++){b.fill(0);for(let t=0;t<r;t++)es(b,ec(ea(g.get(t,e)),c[t]));en.decode(b);let{r0:t,r1:n}=K(es(b,d[e]));p.push(t),y.push(n)}let w=U.encode([o,y]),A=F(w,{dkLen:f}),L=I.encode([o,i,A,u,d,p]);return g.clean(),s.clean(),C(o,l,i,u,d,c,b,p,y,A,n),{publicKey:w,secretKey:L}},sign:(e,i,s)=>{let[f,y,w,A,L,k]=I.decode(e),m=[],U=a(f);for(let e=0;e<t;e++){let t=[];for(let n=0;n<r;n++)t.push(ea(U.get(n,e)));m.push(t)}U.clean();for(let e=0;e<r;e++)en.encode(A[e]);for(let e=0;e<t;e++)en.encode(L[e]),en.encode(k[e]);let _=F.create({dkLen:d}).update(w).update(i).digest(),B=s||new Uint8Array(32);l(B);let K=F.create({dkLen:d}).update(y).update(B).update(_).digest();l(K,d);let M=h(K,E.bytesLen);e:for(let e=0;;){let l=[];for(let t=0;t<r;t++,e++)l.push(E.decode(M.get(255&e,e>>8)()));let i=l.map(e=>en.encode(e.slice())),s=[];for(let e=0;e<t;e++){let t=ee(256);for(let n=0;n<r;n++)es(t,ec(m[e][n],i[n]));en.decode(t),s.push(t)}let d=s.map(e=>e.map(g)),f=F.create({dkLen:c}).update(_).update(T.encode(d)).digest(),a=en.encode(x(f)),h=A.map(e=>ec(e,a));for(let e=0;e<r;e++)if(es(en.decode(h[e]),l[e]),ef(h[e],n-p))continue e;let y=0,w=[];for(let e=0;e<t;e++){let t=en.decode(ec(L[e],a)),r=eu(s[e],t).map(b);if(ef(r,o-p))continue e;let n=en.decode(ec(k[e],a));if(ef(n,o))continue e;es(r,n);let l=v(r,d[e]);w.push(l.v),y+=l.cnt}if(y>u)continue;M.clean();let U=O.encode([f,h,w]);return C(f,h,w,a,d,s,i,l,K,_,A,L,k,...m),U}throw Error("Unreachable code path reached, report this error")},verify:(e,o,l)=>{let[i,s]=U.decode(e),h=F(e,{dkLen:f});if(l.length!==O.bytesLen)return!1;let[y,g,b]=O.decode(l);if(!1===b)return!1;for(let e=0;e<r;e++)if(ef(g[e],n-p))return!1;let w=F.create({dkLen:d}).update(h).update(o).digest(),A=en.encode(x(y)),L=g.map(e=>e.slice());for(let e=0;e<r;e++)en.encode(L[e]);let k=[],m=a(i);for(let e=0;e<t;e++){let t=ec(en.encode(ed(s[e])),A),n=ee(256);for(let t=0;t<r;t++)es(n,ec(ea(m.get(t,e)),L[t]));let o=en.decode(eu(n,t));k.push(M(o,b[e]))}m.clean();let E=F.create({dkLen:c}).update(w).update(T.encode(k)).digest();for(let e of b)if(!(e.reduce((e,t)=>e+t,0)<=u))return!1;for(let e of g)if(ef(e,n-p))return!1;return S(y,E)}},Y=(e,t=eh)=>{if(l(e),l(t),t.length>255)throw Error("context should be less than 255 bytes");return function(...e){let t=0;for(let r=0;r<e.length;r++){let n=e[r];l(n),t+=n.length}let r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){let o=e[t];r.set(o,n),n+=o.length}return r}(new Uint8Array([0,t.length]),t,e)};return{internal:G,keygen:G.keygen,signRandBytes:G.signRandBytes,sign:(e,t,r=eh,n)=>{let o=Y(t,r),l=G.sign(e,o,n);return o.fill(0),l},verify:(e,t,r,n=eh)=>G.verify(e,Y(t,n),r)}}({K:6,L:5,D:13,GAMMA1:524288,GAMMA2:261888,TAU:49,ETA:4,OMEGA:55,CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:48,XOF128:Y,XOF256:D})}}]);
