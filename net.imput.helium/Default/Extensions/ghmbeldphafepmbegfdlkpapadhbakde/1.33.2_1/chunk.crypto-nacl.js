"use strict";(self.webpackChunkproton_pass_extension=self.webpackChunkproton_pass_extension||[]).push([["node_modules_openpgp_dist_lightweight_nacl-fast_min_mjs"],{44996:(r,e,a)=>{a.d(e,{default:()=>o});let f="undefined"!=typeof window?window:void 0!==a.g?a.g:"undefined"!=typeof self?self:{},n="object"==typeof f&&"crypto"in f?f.crypto:void 0,o={};var t=function(r){var e,a=new Float64Array(16);if(r)for(e=0;e<r.length;e++)a[e]=r[e];return a},x=function(){throw Error("no PRNG")},c=new Uint8Array(32);c[0]=9;var b=t(),i=t([1]),d=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),y=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),s=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(r,e,a,f){r[e]=a>>24&255,r[e+1]=a>>16&255,r[e+2]=a>>8&255,r[e+3]=255&a,r[e+4]=f>>24&255,r[e+5]=f>>16&255,r[e+6]=f>>8&255,r[e+7]=255&f}function v(r,e,a,f){var n,o=0;for(n=0;n<32;n++)o|=r[e+n]^a[f+n];return(1&o-1>>>8)-1}function A(r,e){var a;for(a=0;a<16;a++)r[a]=0|e[a]}function M(r){var e,a,f=1;for(e=0;e<16;e++)f=Math.floor((a=r[e]+f+65535)/65536),r[e]=a-65536*f;r[0]+=f-1+37*(f-1)}function g(r,e,a){for(var f,n=~(a-1),o=0;o<16;o++)f=n&(r[o]^e[o]),r[o]^=f,e[o]^=f}function U(r,e){var a,f,n,o=t(),x=t();for(a=0;a<16;a++)x[a]=e[a];for(M(x),M(x),M(x),f=0;f<2;f++){for(o[0]=x[0]-65517,a=1;a<15;a++)o[a]=x[a]-65535-(o[a-1]>>16&1),o[a-1]&=65535;o[15]=x[15]-32767-(o[14]>>16&1),n=o[15]>>16&1,o[14]&=65535,g(x,o,1-n)}for(a=0;a<16;a++)r[2*a]=255&x[a],r[2*a+1]=x[a]>>8}function p(r,e){var a=new Uint8Array(32),f=new Uint8Array(32);return U(a,r),U(f,e),v(a,0,f,0)}function k(r){var e=new Uint8Array(32);return U(e,r),1&e[0]}function K(r,e){var a;for(a=0;a<16;a++)r[a]=e[2*a]+(e[2*a+1]<<8);r[15]&=32767}function _(r,e,a){for(var f=0;f<16;f++)r[f]=e[f]+a[f]}function E(r,e,a){for(var f=0;f<16;f++)r[f]=e[f]-a[f]}function m(r,e,a){var f,n,o=0,t=0,x=0,c=0,b=0,i=0,d=0,u=0,l=0,y=0,h=0,s=0,w=0,v=0,A=0,M=0,g=0,U=0,p=0,k=0,K=0,_=0,E=0,m=0,z=0,P=0,F=0,R=0,I=0,G=0,N=0,S=a[0],j=a[1],C=a[2],V=a[3],T=a[4],q=a[5],B=a[6],D=a[7],H=a[8],J=a[9],L=a[10],O=a[11],Q=a[12],W=a[13],X=a[14],Y=a[15];o+=(f=e[0])*S,t+=f*j,x+=f*C,c+=f*V,b+=f*T,i+=f*q,d+=f*B,u+=f*D,l+=f*H,y+=f*J,h+=f*L,s+=f*O,w+=f*Q,v+=f*W,A+=f*X,M+=f*Y,t+=(f=e[1])*S,x+=f*j,c+=f*C,b+=f*V,i+=f*T,d+=f*q,u+=f*B,l+=f*D,y+=f*H,h+=f*J,s+=f*L,w+=f*O,v+=f*Q,A+=f*W,M+=f*X,g+=f*Y,x+=(f=e[2])*S,c+=f*j,b+=f*C,i+=f*V,d+=f*T,u+=f*q,l+=f*B,y+=f*D,h+=f*H,s+=f*J,w+=f*L,v+=f*O,A+=f*Q,M+=f*W,g+=f*X,U+=f*Y,c+=(f=e[3])*S,b+=f*j,i+=f*C,d+=f*V,u+=f*T,l+=f*q,y+=f*B,h+=f*D,s+=f*H,w+=f*J,v+=f*L,A+=f*O,M+=f*Q,g+=f*W,U+=f*X,p+=f*Y,b+=(f=e[4])*S,i+=f*j,d+=f*C,u+=f*V,l+=f*T,y+=f*q,h+=f*B,s+=f*D,w+=f*H,v+=f*J,A+=f*L,M+=f*O,g+=f*Q,U+=f*W,p+=f*X,k+=f*Y,i+=(f=e[5])*S,d+=f*j,u+=f*C,l+=f*V,y+=f*T,h+=f*q,s+=f*B,w+=f*D,v+=f*H,A+=f*J,M+=f*L,g+=f*O,U+=f*Q,p+=f*W,k+=f*X,K+=f*Y,d+=(f=e[6])*S,u+=f*j,l+=f*C,y+=f*V,h+=f*T,s+=f*q,w+=f*B,v+=f*D,A+=f*H,M+=f*J,g+=f*L,U+=f*O,p+=f*Q,k+=f*W,K+=f*X,_+=f*Y,u+=(f=e[7])*S,l+=f*j,y+=f*C,h+=f*V,s+=f*T,w+=f*q,v+=f*B,A+=f*D,M+=f*H,g+=f*J,U+=f*L,p+=f*O,k+=f*Q,K+=f*W,_+=f*X,E+=f*Y,l+=(f=e[8])*S,y+=f*j,h+=f*C,s+=f*V,w+=f*T,v+=f*q,A+=f*B,M+=f*D,g+=f*H,U+=f*J,p+=f*L,k+=f*O,K+=f*Q,_+=f*W,E+=f*X,m+=f*Y,y+=(f=e[9])*S,h+=f*j,s+=f*C,w+=f*V,v+=f*T,A+=f*q,M+=f*B,g+=f*D,U+=f*H,p+=f*J,k+=f*L,K+=f*O,_+=f*Q,E+=f*W,m+=f*X,z+=f*Y,h+=(f=e[10])*S,s+=f*j,w+=f*C,v+=f*V,A+=f*T,M+=f*q,g+=f*B,U+=f*D,p+=f*H,k+=f*J,K+=f*L,_+=f*O,E+=f*Q,m+=f*W,z+=f*X,P+=f*Y,s+=(f=e[11])*S,w+=f*j,v+=f*C,A+=f*V,M+=f*T,g+=f*q,U+=f*B,p+=f*D,k+=f*H,K+=f*J,_+=f*L,E+=f*O,m+=f*Q,z+=f*W,P+=f*X,F+=f*Y,w+=(f=e[12])*S,v+=f*j,A+=f*C,M+=f*V,g+=f*T,U+=f*q,p+=f*B,k+=f*D,K+=f*H,_+=f*J,E+=f*L,m+=f*O,z+=f*Q,P+=f*W,F+=f*X,R+=f*Y,v+=(f=e[13])*S,A+=f*j,M+=f*C,g+=f*V,U+=f*T,p+=f*q,k+=f*B,K+=f*D,_+=f*H,E+=f*J,m+=f*L,z+=f*O,P+=f*Q,F+=f*W,R+=f*X,I+=f*Y,A+=(f=e[14])*S,M+=f*j,g+=f*C,U+=f*V,p+=f*T,k+=f*q,K+=f*B,_+=f*D,E+=f*H,m+=f*J,z+=f*L,P+=f*O,F+=f*Q,R+=f*W,I+=f*X,G+=f*Y,M+=(f=e[15])*S,t+=38*(U+=f*C),x+=38*(p+=f*V),c+=38*(k+=f*T),b+=38*(K+=f*q),i+=38*(_+=f*B),d+=38*(E+=f*D),u+=38*(m+=f*H),l+=38*(z+=f*J),y+=38*(P+=f*L),h+=38*(F+=f*O),s+=38*(R+=f*Q),w+=38*(I+=f*W),v+=38*(G+=f*X),A+=38*(N+=f*Y),o=(f=(o+=38*(g+=f*j))+(n=1)+65535)-65536*(n=Math.floor(f/65536)),t=(f=t+n+65535)-65536*(n=Math.floor(f/65536)),x=(f=x+n+65535)-65536*(n=Math.floor(f/65536)),c=(f=c+n+65535)-65536*(n=Math.floor(f/65536)),b=(f=b+n+65535)-65536*(n=Math.floor(f/65536)),i=(f=i+n+65535)-65536*(n=Math.floor(f/65536)),d=(f=d+n+65535)-65536*(n=Math.floor(f/65536)),u=(f=u+n+65535)-65536*(n=Math.floor(f/65536)),l=(f=l+n+65535)-65536*(n=Math.floor(f/65536)),y=(f=y+n+65535)-65536*(n=Math.floor(f/65536)),h=(f=h+n+65535)-65536*(n=Math.floor(f/65536)),s=(f=s+n+65535)-65536*(n=Math.floor(f/65536)),w=(f=w+n+65535)-65536*(n=Math.floor(f/65536)),v=(f=v+n+65535)-65536*(n=Math.floor(f/65536)),A=(f=A+n+65535)-65536*(n=Math.floor(f/65536)),M=(f=M+n+65535)-65536*(n=Math.floor(f/65536)),o=(f=(o+=n-1+37*(n-1))+(n=1)+65535)-65536*(n=Math.floor(f/65536)),t=(f=t+n+65535)-65536*(n=Math.floor(f/65536)),x=(f=x+n+65535)-65536*(n=Math.floor(f/65536)),c=(f=c+n+65535)-65536*(n=Math.floor(f/65536)),b=(f=b+n+65535)-65536*(n=Math.floor(f/65536)),i=(f=i+n+65535)-65536*(n=Math.floor(f/65536)),d=(f=d+n+65535)-65536*(n=Math.floor(f/65536)),u=(f=u+n+65535)-65536*(n=Math.floor(f/65536)),l=(f=l+n+65535)-65536*(n=Math.floor(f/65536)),y=(f=y+n+65535)-65536*(n=Math.floor(f/65536)),h=(f=h+n+65535)-65536*(n=Math.floor(f/65536)),s=(f=s+n+65535)-65536*(n=Math.floor(f/65536)),w=(f=w+n+65535)-65536*(n=Math.floor(f/65536)),v=(f=v+n+65535)-65536*(n=Math.floor(f/65536)),A=(f=A+n+65535)-65536*(n=Math.floor(f/65536)),M=(f=M+n+65535)-65536*(n=Math.floor(f/65536)),o+=n-1+37*(n-1),r[0]=o,r[1]=t,r[2]=x,r[3]=c,r[4]=b,r[5]=i,r[6]=d,r[7]=u,r[8]=l,r[9]=y,r[10]=h,r[11]=s,r[12]=w,r[13]=v,r[14]=A,r[15]=M}function z(r,e){m(r,e,e)}function P(r,e){var a,f=t();for(a=0;a<16;a++)f[a]=e[a];for(a=253;a>=0;a--)z(f,f),2!==a&&4!==a&&m(f,f,e);for(a=0;a<16;a++)r[a]=f[a]}function F(r,e,a){var f,n,o=new Uint8Array(32),x=new Float64Array(80),c=t(),b=t(),i=t(),u=t(),l=t(),y=t();for(n=0;n<31;n++)o[n]=e[n];for(o[31]=127&e[31]|64,o[0]&=248,K(x,a),n=0;n<16;n++)b[n]=x[n],u[n]=c[n]=i[n]=0;for(c[0]=u[0]=1,n=254;n>=0;--n)g(c,b,f=o[n>>>3]>>>(7&n)&1),g(i,u,f),_(l,c,i),E(c,c,i),_(i,b,u),E(b,b,u),z(u,l),z(y,c),m(c,i,c),m(i,b,l),_(l,c,i),E(c,c,i),z(b,c),E(i,u,y),m(c,i,d),_(c,c,u),m(i,i,c),m(c,u,y),m(u,b,x),z(b,l),g(c,b,f),g(i,u,f);for(n=0;n<16;n++)x[n+16]=c[n],x[n+32]=i[n],x[n+48]=b[n],x[n+64]=u[n];var h=x.subarray(32),s=x.subarray(16);return P(h,h),m(s,s,h),U(r,s),0}var R=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function I(r,e,a,f){for(var n,o,t,x,c,b,i,d,u,l,y,h,s,w,v,A,M,g,U,p,k,K,_,E,m,z,P=new Int32Array(16),F=new Int32Array(16),I=r[0],G=r[1],N=r[2],S=r[3],j=r[4],C=r[5],V=r[6],T=r[7],q=e[0],B=e[1],D=e[2],H=e[3],J=e[4],L=e[5],O=e[6],Q=e[7],W=0;f>=128;){for(U=0;U<16;U++)p=8*U+W,P[U]=a[p+0]<<24|a[p+1]<<16|a[p+2]<<8|a[p+3],F[U]=a[p+4]<<24|a[p+5]<<16|a[p+6]<<8|a[p+7];for(U=0;U<80;U++)if(n=I,o=G,t=N,x=S,c=j,b=C,i=V,u=q,l=B,y=D,h=H,s=J,w=L,v=O,_=65535&(K=Q),E=K>>>16,m=65535&(k=T),z=k>>>16,_+=65535&(K=(J>>>14|j<<18)^(J>>>18|j<<14)^(j>>>9|J<<23)),E+=K>>>16,m+=65535&(k=(j>>>14|J<<18)^(j>>>18|J<<14)^(J>>>9|j<<23)),z+=k>>>16,_+=65535&(K=J&L^~J&O),E+=K>>>16,m+=65535&(k=j&C^~j&V),z+=k>>>16,_+=65535&(K=R[2*U+1]),E+=K>>>16,m+=65535&(k=R[2*U]),z+=k>>>16,k=P[U%16],E+=(K=F[U%16])>>>16,m+=65535&k,z+=k>>>16,m+=(E+=(_+=65535&K)>>>16)>>>16,_=65535&(K=g=65535&_|E<<16),E=K>>>16,m=65535&(k=M=65535&m|(z+=m>>>16)<<16),z=k>>>16,_+=65535&(K=(q>>>28|I<<4)^(I>>>2|q<<30)^(I>>>7|q<<25)),E+=K>>>16,m+=65535&(k=(I>>>28|q<<4)^(q>>>2|I<<30)^(q>>>7|I<<25)),z+=k>>>16,E+=(K=q&B^q&D^B&D)>>>16,m+=65535&(k=I&G^I&N^G&N),z+=k>>>16,d=65535&(m+=(E+=(_+=65535&K)>>>16)>>>16)|(z+=m>>>16)<<16,A=65535&_|E<<16,_=65535&(K=h),E=K>>>16,m=65535&(k=x),z=k>>>16,E+=(K=g)>>>16,m+=65535&(k=M),z+=k>>>16,G=n,N=o,S=t,j=x=65535&(m+=(E+=(_+=65535&K)>>>16)>>>16)|(z+=m>>>16)<<16,C=c,V=b,T=i,I=d,B=u,D=l,H=y,J=h=65535&_|E<<16,L=s,O=w,Q=v,q=A,U%16==15)for(p=0;p<16;p++)k=P[p],_=65535&(K=F[p]),E=K>>>16,m=65535&k,z=k>>>16,k=P[(p+9)%16],_+=65535&(K=F[(p+9)%16]),E+=K>>>16,m+=65535&k,z+=k>>>16,M=P[(p+1)%16],_+=65535&(K=((g=F[(p+1)%16])>>>1|M<<31)^(g>>>8|M<<24)^(g>>>7|M<<25)),E+=K>>>16,m+=65535&(k=(M>>>1|g<<31)^(M>>>8|g<<24)^M>>>7),z+=k>>>16,M=P[(p+14)%16],E+=(K=((g=F[(p+14)%16])>>>19|M<<13)^(M>>>29|g<<3)^(g>>>6|M<<26))>>>16,m+=65535&(k=(M>>>19|g<<13)^(g>>>29|M<<3)^M>>>6),z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),P[p]=65535&m|z<<16,F[p]=65535&_|E<<16;_=65535&(K=q),E=K>>>16,m=65535&(k=I),z=k>>>16,k=r[0],E+=(K=e[0])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[0]=I=65535&m|z<<16,e[0]=q=65535&_|E<<16,_=65535&(K=B),E=K>>>16,m=65535&(k=G),z=k>>>16,k=r[1],E+=(K=e[1])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[1]=G=65535&m|z<<16,e[1]=B=65535&_|E<<16,_=65535&(K=D),E=K>>>16,m=65535&(k=N),z=k>>>16,k=r[2],E+=(K=e[2])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[2]=N=65535&m|z<<16,e[2]=D=65535&_|E<<16,_=65535&(K=H),E=K>>>16,m=65535&(k=S),z=k>>>16,k=r[3],E+=(K=e[3])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[3]=S=65535&m|z<<16,e[3]=H=65535&_|E<<16,_=65535&(K=J),E=K>>>16,m=65535&(k=j),z=k>>>16,k=r[4],E+=(K=e[4])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[4]=j=65535&m|z<<16,e[4]=J=65535&_|E<<16,_=65535&(K=L),E=K>>>16,m=65535&(k=C),z=k>>>16,k=r[5],E+=(K=e[5])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[5]=C=65535&m|z<<16,e[5]=L=65535&_|E<<16,_=65535&(K=O),E=K>>>16,m=65535&(k=V),z=k>>>16,k=r[6],E+=(K=e[6])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[6]=V=65535&m|z<<16,e[6]=O=65535&_|E<<16,_=65535&(K=Q),E=K>>>16,m=65535&(k=T),z=k>>>16,k=r[7],E+=(K=e[7])>>>16,m+=65535&k,z+=(k>>>16)+((m+=(E+=(_+=65535&K)>>>16)>>>16)>>>16),r[7]=T=65535&m|z<<16,e[7]=Q=65535&_|E<<16,W+=128,f-=128}return f}function G(r,e,a){var f,n=new Int32Array(8),o=new Int32Array(8),t=new Uint8Array(256),x=a;for(n[0]=0x6a09e667,n[1]=0xbb67ae85,n[2]=0x3c6ef372,n[3]=0xa54ff53a,n[4]=0x510e527f,n[5]=0x9b05688c,n[6]=0x1f83d9ab,n[7]=0x5be0cd19,o[0]=0xf3bcc908,o[1]=0x84caa73b,o[2]=0xfe94f82b,o[3]=0x5f1d36f1,o[4]=0xade682d1,o[5]=0x2b3e6c1f,o[6]=0xfb41bd6b,o[7]=0x137e2179,I(n,o,e,a),a%=128,f=0;f<a;f++)t[f]=e[x-a+f];for(t[a]=128,t[(a=256-(a<112)*128)-9]=0,w(t,a-8,x/0x20000000|0,x<<3),I(n,o,t,a),f=0;f<8;f++)w(r,8*f,n[f],o[f]);return 0}function N(r,e){var a=t(),f=t(),n=t(),o=t(),x=t(),c=t(),b=t(),i=t(),d=t();E(a,r[1],r[0]),E(d,e[1],e[0]),m(a,a,d),_(f,r[0],r[1]),_(d,e[0],e[1]),m(f,f,d),m(n,r[3],e[3]),m(n,n,l),m(o,r[2],e[2]),_(o,o,o),E(x,f,a),E(c,o,n),_(b,o,n),_(i,f,a),m(r[0],x,c),m(r[1],i,b),m(r[2],b,c),m(r[3],x,i)}function S(r,e,a){var f;for(f=0;f<4;f++)g(r[f],e[f],a)}function j(r,e){var a=t(),f=t(),n=t();P(n,e[2]),m(a,e[0],n),m(f,e[1],n),U(r,f),r[31]^=k(a)<<7}function C(r,e,a){var f,n;for(A(r[0],b),A(r[1],i),A(r[2],i),A(r[3],b),n=255;n>=0;--n)S(r,e,f=a[n/8|0]>>(7&n)&1),N(e,r),N(r,r),S(r,e,f)}function V(r,e){var a=[t(),t(),t(),t()];A(a[0],y),A(a[1],h),A(a[2],i),m(a[3],y,h),C(r,a,e)}function T(r,e,a){var f,n=new Uint8Array(64),o=[t(),t(),t(),t()];for(a||x(e,32),G(n,e,32),n[0]&=248,n[31]&=127,n[31]|=64,V(o,n),j(r,o),f=0;f<32;f++)e[f+32]=r[f];return 0}var q=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function B(r,e){var a,f,n,o;for(f=63;f>=32;--f){for(a=0,n=f-32,o=f-12;n<o;++n)e[n]+=a-16*e[f]*q[n-(f-32)],a=Math.floor((e[n]+128)/256),e[n]-=256*a;e[n]+=a,e[f]=0}for(a=0,n=0;n<32;n++)e[n]+=a-(e[31]>>4)*q[n],a=e[n]>>8,e[n]&=255;for(n=0;n<32;n++)e[n]-=a*q[n];for(f=0;f<32;f++)e[f+1]+=e[f]>>8,r[f]=255&e[f]}function D(r){var e,a=new Float64Array(64);for(e=0;e<64;e++)a[e]=r[e];for(e=0;e<64;e++)r[e]=0;B(r,a)}function H(){for(var r=0;r<arguments.length;r++)if(!(arguments[r]instanceof Uint8Array))throw TypeError("unexpected type, use Uint8Array")}o.scalarMult=function(r,e){if(H(r,e),32!==r.length)throw Error("bad n size");if(32!==e.length)throw Error("bad p size");var a=new Uint8Array(32);return F(a,r,e),a},o.box={},o.box.keyPair=function(){var r=new Uint8Array(32),e=new Uint8Array(32);return x(e,32),F(r,e,c),{publicKey:r,secretKey:e}},o.box.keyPair.fromSecretKey=function(r){if(H(r),32!==r.length)throw Error("bad secret key size");var e=new Uint8Array(32);return F(e,r,c),{publicKey:e,secretKey:new Uint8Array(r)}},o.sign=function(r,e){if(H(r,e),64!==e.length)throw Error("bad secret key size");var a=new Uint8Array(64+r.length);return function(r,e,a,f){var n,o,x=new Uint8Array(64),c=new Uint8Array(64),b=new Uint8Array(64),i=new Float64Array(64),d=[t(),t(),t(),t()];for(G(x,f,32),x[0]&=248,x[31]&=127,x[31]|=64,n=0;n<a;n++)r[64+n]=e[n];for(n=0;n<32;n++)r[32+n]=x[32+n];for(G(b,r.subarray(32),a+32),D(b),V(d,b),j(r,d),n=32;n<64;n++)r[n]=f[n];for(G(c,r,a+64),D(c),n=0;n<64;n++)i[n]=0;for(n=0;n<32;n++)i[n]=b[n];for(n=0;n<32;n++)for(o=0;o<32;o++)i[n+o]+=c[n]*x[o];B(r.subarray(32),i)}(a,r,r.length,e),a},o.sign.detached=function(r,e){for(var a=o.sign(r,e),f=new Uint8Array(64),n=0;n<f.length;n++)f[n]=a[n];return f},o.sign.detached.verify=function(r,e,a){if(H(r,e,a),64!==e.length)throw Error("bad signature size");if(32!==a.length)throw Error("bad public key size");var f,n=new Uint8Array(64+r.length),o=new Uint8Array(64+r.length);for(f=0;f<64;f++)n[f]=e[f];for(f=0;f<r.length;f++)n[f+64]=r[f];return function(r,e,a,f){var n,o,x,c,d,l,y,h,w=new Uint8Array(32),M=new Uint8Array(64),g=[t(),t(),t(),t()],U=[t(),t(),t(),t()];if(a<64||(n=t(),o=t(),x=t(),c=t(),d=t(),l=t(),y=t(),A(U[2],i),K(U[1],f),z(x,U[1]),m(c,x,u),E(x,x,U[2]),_(c,U[2],c),z(d,c),z(l,d),m(y,l,d),m(n,y,x),m(n,n,c),function(r,e){var a,f=t();for(a=0;a<16;a++)f[a]=e[a];for(a=250;a>=0;a--)z(f,f),1!==a&&m(f,f,e);for(a=0;a<16;a++)r[a]=f[a]}(n,n),m(n,n,x),m(n,n,c),m(n,n,c),m(U[0],n,c),z(o,U[0]),m(o,o,c),p(o,x)&&m(U[0],U[0],s),z(o,U[0]),m(o,o,c),p(o,x)?-1:(k(U[0])===f[31]>>7&&E(U[0],b,U[0]),m(U[3],U[0],U[1]),0)))return -1;for(h=0;h<a;h++)r[h]=e[h];for(h=0;h<32;h++)r[h+32]=f[h];if(G(M,r,a),D(M),C(g,U,M),V(U,e.subarray(32)),N(g,U),j(w,g),a-=64,v(e,0,w,0)){for(h=0;h<a;h++)r[h]=0;return -1}for(h=0;h<a;h++)r[h]=e[h+64];return a}(o,n,n.length,a)>=0},o.sign.keyPair=function(){var r=new Uint8Array(32),e=new Uint8Array(64);return T(r,e),{publicKey:r,secretKey:e}},o.sign.keyPair.fromSecretKey=function(r){if(H(r),64!==r.length)throw Error("bad secret key size");for(var e=new Uint8Array(32),a=0;a<e.length;a++)e[a]=r[32+a];return{publicKey:e,secretKey:new Uint8Array(r)}},o.sign.keyPair.fromSeed=function(r){if(H(r),32!==r.length)throw Error("bad seed size");for(var e=new Uint8Array(32),a=new Uint8Array(64),f=0;f<32;f++)a[f]=r[f];return T(e,a,!0),{publicKey:e,secretKey:a}},o.setPRNG=function(r){x=r},n&&n.getRandomValues&&o.setPRNG(function(r,e){var a,f=new Uint8Array(e);for(a=0;a<e;a+=65536)n.getRandomValues(f.subarray(a,a+Math.min(e-a,65536)));for(a=0;a<e;a++)r[a]=f[a];for(var o=0;o<f.length;o++)f[o]=0})}}]);
